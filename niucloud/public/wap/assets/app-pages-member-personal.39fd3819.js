import{d as e,r as a,x as l,y as t,o,c as r,w as i,g as n,v as s,e as u,j as p,m as d,q as m,s as c,L as f,f as v,B as y,C as _,i as x,A as h,c3 as b,E as k,z as g,c4 as j,aQ as w,k as C,l as S,K as z,I as D,p as I,S as N,c5 as q,b as A}from"./index-c3bd19d7.js";import{_ as F}from"./u-avatar.3cbc3643.js";import{_ as V}from"./u-upload.679b838d.js";import{_ as B,a as L}from"./u-cell-group.9277218c.js";import{_ as O}from"./u-popup.3041e24a.js";import{_ as E}from"./u-action-sheet.e4f87e9c.js";import{d as P,_ as $}from"./index.5249df87.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.fed07783.js";import"./u-text.cec1c8ef.js";import"./u-loading-icon.e306857f.js";import"./u-line.5f9fdeba.js";import"./u-transition.35c8ef6d.js";import"./u-safe-bottom.d8b3ca1a.js";import"./top-tabbar.69347ce8.js";import"./manifest.bb26aff2.js";import"./area-select.vue_vue_type_script_setup_true_lang.57d01e4b.js";import"./u-checkbox.629328c6.js";import"./u-checkbox-group.20dda01a.js";import"./u-button.4f0c93a5.js";import"./u-input.20a1a434.js";import"./diy_form.8f05982e.js";import"./u-parse.6a681d04.js";import"./tabbar.2ac3b53f.js";import"./recycle.43992927.js";const U=e({__name:"personal_form_detail",props:["data","completeLayout"],setup(e){const m=e,c=a(!0),f=l({global:{},value:[]});return t(()=>{f.global.completeLayout=m.completeLayout||"style-1",m.data.formField&&m.data.formField.forEach(e=>{let a={componentIsShow:!0,id:e.field_key,componentName:e.field_type,pageStyle:"",viewFormDetail:!0,isShowArrow:!0,field:{name:e.field_name,value:e.field_value,required:e.field_required,unique:e.field_unique,privacyProtection:e.privacy_protection},margin:{top:0,bottom:0,both:0}};try{a.field.value=JSON.parse(e.field_value),"FormNumber"!=a.componentName&&"FormIdentity"!=a.componentName||(a.field.value=String(e.field_value))}catch(l){a.field.value=e.field_value}f.value.push(a)}),c.value=!1}),(e,a)=>{const l=d;return o(),r(l,{style:p(e.themeColor()),class:"my-[var(--top-m)] sidebar-margin overflow-hidden card-template py-[12rpx] px-[26rpx]"},{default:i(()=>[n(u(l,{class:"diy-template-wrap"},{default:i(()=>[u(P,{ref:"diyGroupRef",data:f},null,8,["data"])]),_:1},512),[[s,!c.value]])]),_:1},8,["style"])}}}),G=R(e({__name:"personal",setup(e){const t=m(),n=c(()=>t.info);a(null),f(()=>{});const s=l({modal:!1,value:n.nickname||""}),P=e=>{s.value=e.detail.value};let R=a(null);b().then(e=>{R.value=e.data});const G=()=>{uni.$u.test.isEmpty(s.value)?k({title:g("nicknamePlaceholder"),icon:"none"}):j({field:"nickname",value:s.value}).then(e=>{t.info.nickname=s.value,s.modal=!1})},J=a(!1),K=c(()=>[{name:g("man"),value:1},{name:g("woman"),value:2}]),M=e=>{j({field:"sex",value:e.value}).then(a=>{t.info.sex_name=e.name})},Q=e=>{w({filePath:e.file.url,name:"file"}).then(e=>{j({field:"headimg",value:e.data.url}).then(()=>{t.info.headimg=e.data.url})}).catch(()=>{})},T=a(!1),H=e=>{j({field:"birthday",value:uni.$u.date(e.value,"yyyy-mm-dd")}).then(()=>{t.info.birthday=uni.$u.date(e.value||e.value+1,"yyyy-mm-dd"),T.value=!1})};return(e,a)=>{const l=C(S("u-avatar"),F),t=C(S("u-upload"),V),m=C(S("u-cell"),B),c=d,f=z,b=C(S("u-cell-group"),L),k=D,j=C(S("u-popup"),O),w=C(S("u-action-sheet"),E),W=C(S("u-datetime-picker"),$),X=I("layout-default-uni");return o(),r(X,null,{default:i(()=>[v(n)?(o(),r(c,{key:0,class:"w-full min-h-screen bg-page personal-wrap !pb-[20rpx] overflow-hidden",style:p(e.themeColor())},{default:i(()=>[u(c,{class:"my-[var(--top-m)] sidebar-margin overflow-hidden card-template py-[20rpx]"},{default:i(()=>[u(b,{border:!1,class:"cell-group"},{default:i(()=>{return[u(m,{title:v(g)("headimg"),titleStyle:{"font-size":"28rpx"},"is-link":!0},{value:i(()=>[u(t,{onAfterRead:Q,maxCount:1},{default:i(()=>[u(l,{src:v(N)(v(n).headimg),"default-url":v(N)("static/resource/images/default_headimg.png"),size:"40",leftIcon:"none"},null,8,["src","default-url"])]),_:1})]),_:1},8,["title"]),u(m,{title:v(g)("nickname"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:v(n).nickname,onClick:a[0]||(a[0]=e=>s.modal=!0)},null,8,["title","value"]),u(m,{title:v(g)("sex"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:v(n).sex_name||v(g)("unknown"),onClick:a[1]||(a[1]=e=>J.value=!0)},null,8,["title","value"]),u(m,{title:v(g)("mobile"),titleStyle:{"font-size":"28rpx"}},{value:i(()=>[v(n).mobile?(o(),r(c,{key:0,class:"mr-[10rpx]"},{default:i(()=>[y(_(v(q)(v(n).mobile)),1)]),_:1})):(o(),r(c,{key:1},{default:i(()=>[u(f,{onClick:a[2]||(a[2]=e=>v(A)({url:"/app/pages/auth/bind"})),class:"bg-transparent w-[170rpx] p-[0] rounded-[100rpx] text-[var(--primary-color)] !border-[2rpx] !border-solid border-[var(--primary-color)] text-[24rpx] h-[54rpx] flex-center"},{default:i(()=>[y(_(v(g)("bindMobile")),1)]),_:1})]),_:1}))]),_:1},8,["title"]),u(m,{title:v(g)("birthday"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:(e=v(n).birthday,(e?uni.$u.date(new Date(e),"yyyy-mm-dd"):"")||v(g)("unknown")),onClick:a[3]||(a[3]=e=>T.value=!0)},null,8,["title","value"])];var e}),_:1})]),_:1}),x(" 商品的万能表单信息 "),u(c,{onClick:a[4]||(a[4]=e=>v(A)({url:"/app/pages/member/personal_form",param:{form_id:v(n).form_id,form_record_id:v(n).form_record_id}}))},{default:i(()=>[v(R)&&Object.keys(v(R)).length?(o(),r(U,{key:0,class:"personal-form",data:v(R),completeLayout:"style-2"},null,8,["data"])):x("v-if",!0)]),_:1}),x(" 修改昵称 "),u(j,{class:"popup-type",safeAreaInsetBottom:!1,round:"var(--rounded-big)",show:s.modal,mode:"center",onClose:a[7]||(a[7]=e=>s.modal=!1)},{default:i(()=>[u(c,{class:"w-[620rpx] popup-common pb-[40rpx]",onTouchmove:a[6]||(a[6]=h(()=>{},["prevent","stop"]))},{default:i(()=>[u(c,{class:"title !pt-[50rpx] !pb-[60rpx]"},{default:i(()=>[y(_(v(g)("updateNickname")),1)]),_:1}),u(c,{class:"mx-[50rpx] border-0 border-b border-[#eee] border-solid"},{default:i(()=>[u(k,{type:"nickname",class:"h-[88rpx] text-[26rpx]",modelValue:s.value,"onUpdate:modelValue":a[5]||(a[5]=e=>s.value=e),placeholder:v(g)("nicknamePlaceholder"),placeholderClass:"text-[26rpx] h-[88rpx] flex items-center",onBlur:P},null,8,["modelValue","placeholder"])]),_:1}),u(c,{class:"px-[60rpx] pt-[70rpx]"},{default:i(()=>[u(f,{"hover-class":"none",class:"primary-btn-bg text-[#fff] h-[80rpx] font-500 leading-[80rpx] rounded-[100rpx] text-[26rpx]",onClick:G},{default:i(()=>[y(_(v(g)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),x(" 修改性别 "),u(w,{actions:v(K),show:J.value,closeOnClickOverlay:!0,safeAreaInsetBottom:!0,onClose:a[8]||(a[8]=e=>J.value=!1),onSelect:M},null,8,["actions","show"]),x(" 修改生日 "),u(W,{modelValue:v(n).birthday,"onUpdate:modelValue":a[9]||(a[9]=e=>v(n).birthday=e),show:T.value,mode:"date","confirm-text":v(g)("confirm"),maxDate:(new Date).valueOf(),minDate:0,"cancel-text":v(g)("cancel"),onCancel:a[10]||(a[10]=e=>T.value=!1),onConfirm:H},null,8,["modelValue","show","confirm-text","maxDate","cancel-text"])]),_:1},8,["style"])):x("v-if",!0)]),_:1})}}}),[["__scopeId","data-v-f7dcb315"]]);export{G as default};
