import{d as e,a as t,s as a,q as r,r as o,x as l,L as s,z as i,o as n,c as u,w as p,e as m,B as d,C as c,f as g,A as b,i as x,j as f,F as _,X as h,b as y,H as v,m as k,k as S,l as j,J as C,K as T,p as w,T as V,t as F}from"./index-5dd3a833.js";import{_ as O}from"./u-input.c864510e.js";import{_ as B,a as I}from"./u-form.8a5e7be8.js";import{_ as P}from"./sms-code.vue_vue_type_script_setup_true_lang.7b18027f.js";import{_ as z}from"./u-checkbox.8fdcff45.js";import{_ as A}from"./u-checkbox-group.f4041679.js";import{t as q}from"./topTabbar.bf25bba3.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.2d8c39b5.js";import"./u-line.5e2da613.js";import"./u-modal.58ad5f0d.js";import"./u-loading-icon.63963092.js";import"./u-popup.b109731e.js";import"./u-transition.22a584d7.js";import"./u-safe-bottom.94dec507.js";const U=M(e({__name:"bind",setup(e){const M=t();q().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a(()=>Object.keys(M.menuButtonInfo).length?V(Number(M.menuButtonInfo.height))+V(M.menuButtonInfo.top)+V(8)+"rpx":"auto");const U=r(),E=a(()=>U.info),H=a(()=>F().login),J=o(!1),K=o(!1),L=l({mobile:"",mobile_code:"",mobile_key:"",register_type:""}),N=o(!0);s(e=>{setTimeout(()=>{N.value=!1},800),e.register_type&&Object.assign(L,{register_type:e.register_type}),uni.getStorageSync("openid")&&Object.assign(L,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(L,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(L,{unionid:uni.getStorageSync("unionid")}),uni.getStorageSync("nickname")&&Object.assign(L,{nickname:uni.getStorageSync("nickname")}),uni.getStorageSync("avatar")&&Object.assign(L,{avatar:uni.getStorageSync("avatar")})});const R={mobile:[{type:"string",required:!0,message:i("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,t,a){/^1[3-9]\d{9}$/.test(t)?a():a(new Error("请输入正确的手机号"))},message:i("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:i("codePlaceholder"),trigger:["blur","change"]}},X=()=>{K.value=!K.value},$=o(null),D=()=>{$.value.validate().then(()=>{if(J.value)return;J.value=!0;(E.value?_:h)(L).then(e=>{E.value?(U.getMemberInfo(),y({url:"/app/pages/member/personal",mode:"redirectTo"})):(U.setToken(e.data.token),v().handleLoginBack())}).catch(()=>{J.value=!1})})};return(e,t)=>{const a=k,r=S(j("u-input"),O),o=S(j("u-form-item"),B),l=S(j("sms-code"),P),s=S(j("u-form"),I),_=S(j("u-checkbox"),z),h=S(j("u-checkbox-group"),A),v=C,V=T,F=w("layout-default-uni");return n(),u(F,null,{default:p(()=>[m(a,{class:"w-screen h-screen flex flex-col",style:f(e.themeColor())},{default:p(()=>[m(a,{class:"mx-[60rpx]"},{default:p(()=>[m(a,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:p(()=>[d(c(g(i)("bindMobile")),1)]),_:1}),m(a,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[24rpx] mb-[90rpx]"},{default:p(()=>[d(c(g(i)("bindMobileTip")),1)]),_:1}),m(s,{labelPosition:"left",model:L,errorType:"toast",rules:R,ref_key:"formRef",ref:$},{default:p(()=>[m(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6]"},{default:p(()=>[m(o,{label:"",prop:"mobile","border-bottom":!1},{default:p(()=>[m(r,{modelValue:L.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>L.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:g(i)("mobilePlaceholder"),class:"!bg-transparent",disabled:N.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])]),_:1})]),_:1}),m(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:p(()=>[m(o,{label:"",prop:"mobile_code","border-bottom":!1},{default:p(()=>[m(r,{modelValue:L.mobile_code,"onUpdate:modelValue":t[2]||(t[2]=e=>L.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:g(i)("codePlaceholder"),class:"!bg-transparent",disabled:N.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:p(()=>[m(l,{mobile:L.mobile,type:"bind_mobile",modelValue:L.mobile_key,"onUpdate:modelValue":t[1]||(t[1]=e=>L.mobile_key=e)},null,8,["mobile","modelValue"])]),_:1},8,["modelValue","placeholder","disabled"])]),_:1})]),_:1})]),_:1},8,["model"]),m(a,{class:"mt-[100rpx]"},{default:p(()=>[g(H).agreement_show?(n(),u(a,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:b(X,["stop"])},{default:p(()=>[m(h,{onChange:X},{default:p(()=>[m(_,{activeColor:"var(--primary-color)",checked:K.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])]),_:1}),m(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:p(()=>[m(v,null,{default:p(()=>[d(c(g(i)("agreeTips")),1)]),_:1}),m(v,{onClick:t[3]||(t[3]=b(e=>g(y)({url:"/app/pages/auth/agreement?key=privacy"}),["stop"])),class:"text-primary"},{default:p(()=>[d("《"+c(g(i)("privacyAgreement"))+"》",1)]),_:1}),m(v,null,{default:p(()=>[d(c(g(i)("and")),1)]),_:1}),m(v,{onClick:t[4]||(t[4]=b(e=>g(y)({url:"/app/pages/auth/agreement?key=service"}),["stop"])),class:"text-primary"},{default:p(()=>[d("《"+c(g(i)("userAgreement"))+"》",1)]),_:1})]),_:1})]),_:1},8,["onClick"])):x("v-if",!0),m(V,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:D},{default:p(()=>[d(c(g(i)("bind")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})}}}),[["__scopeId","data-v-90d0692c"]]);export{U as default};
