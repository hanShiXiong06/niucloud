import{d as t,r as e,x as i,bD as a,ad as c,o as l,c as s,w as r,e as o,B as n,D as d,C as p,i as u,A as v,j as y,Y as f,a9 as m,Z as x,m as h,au as k,k as _,l as g,bE as C,n as w}from"./index-c3bd19d7.js";import{_ as b}from"./u-popup.3041e24a.js";const I=t({__name:"area-select",props:{areaId:{type:Number,default:0}},emits:["complete"],setup(t,{expose:I,emit:E}){const T=t,j=e(!1),D=i({province:[],city:[],district:[]}),A=e("province"),B=i({province:null,city:null,district:null}),M=e(0);a(0).then(({data:t})=>{D.province=t}).catch(),c(()=>T.areaId,(t,e)=>{t&&!e&&C(t).then(({data:t})=>{t.province&&(B.province=t.province),t.city&&(B.city=t.city),t.district&&(B.district=t.district)})},{immediate:!0}),c(()=>B.province,()=>{a(B.province.id).then(({data:t})=>{if(D.city=t,A.value="city",B.city){let e=!1,i=-1;for(let a=0;a<t.length;a++)if(B.city.id==t[a].id){e=!0,i=a;break}e?setTimeout(()=>{N("city",i)},100):B.city=null}}).catch()},{deep:!0}),c(()=>B.city,t=>{t?a(B.city.id).then(({data:t})=>{if(D.district=t,A.value="district",B.district){let e=!1,i=-1;for(let a=0;a<t.length;a++)if(B.district.id==t[a].id){e=!0,i=a;break}e?setTimeout(()=>{N("district",i)},100):B.district=null}t.length||(A.value="city",E("complete",B),j.value=!1)}).catch():(D.district=[],B.district=null)},{deep:!0});const N=(t,e)=>{const i=Math.max(0,40*(e-2));M.value=i},Y=()=>{M.value=1,w(()=>{M.value=0})};c(()=>A.value,t=>{w(()=>{if("province"===t&&B.province){const t=D.province.findIndex(t=>t.id===B.province.id);t>=0&&N("province",t)}else if("city"===t&&B.city){const t=D.city.findIndex(t=>t.id===B.city.id);t>=0&&N("city",t)}else if("district"===t&&B.district){const t=D.district.findIndex(t=>t.id===B.district.id);t>=0&&N("district",t)}})},{immediate:!0}),c(()=>B.district,t=>{t&&(A.value="district",E("complete",B),j.value=!1)},{deep:!0});return I({open:()=>{j.value=!0,T.areaId&&(A.value="district")}}),(t,e)=>{const i=h,a=k,c=_(g("u-popup"),b);return l(),s(c,{show:j.value,onClose:e[5]||(e[5]=t=>j.value=!1),mode:"bottom",round:10},{default:r(()=>[o(i,{onTouchmove:e[4]||(e[4]=v(()=>{},["prevent","stop"])),class:"popup-common"},{default:r(()=>[o(i,{class:"title"},{default:r(()=>[n("请选择地区")]),_:1}),o(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500"},{default:r(()=>[D.province.length?(l(),s(i,{key:0,class:d(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"province"==A.value}]),onClick:e[0]||(e[0]=t=>A.value="province")},{default:r(()=>[B.province?(l(),s(i,{key:0},{default:r(()=>[n(p(B.province.name),1)]),_:1})):(l(),s(i,{key:1},{default:r(()=>[n("请选择")]),_:1}))]),_:1},8,["class"])):u("v-if",!0),D.city.length?(l(),s(i,{key:1,class:d(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"city"==A.value}]),onClick:e[1]||(e[1]=t=>A.value="city")},{default:r(()=>[B.city?(l(),s(i,{key:0},{default:r(()=>[n(p(B.city.name),1)]),_:1})):(l(),s(i,{key:1},{default:r(()=>[n("请选择")]),_:1}))]),_:1},8,["class"])):u("v-if",!0),D.district.length?(l(),s(i,{key:2,class:d(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"district"==A.value}]),onClick:e[2]||(e[2]=t=>A.value="district")},{default:r(()=>[B.district?(l(),s(i,{key:0},{default:r(()=>[n(p(B.district.name),1)]),_:1})):(l(),s(i,{key:1},{default:r(()=>[n("请选择")]),_:1}))]),_:1},8,["class"])):(l(),s(i,{key:3,class:"flex-1 pr-[10rpx]"}))]),_:1}),o(a,{"scroll-y":"true",class:"h-[700rpx] overflow-y-auto","scroll-top":M.value,"scroll-with-animation":"",onTouchmove:e[3]||(e[3]=v(()=>{},["stop"]))},{default:r(()=>[o(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500"},{default:r(()=>[D.province.length?(l(),s(i,{key:0,class:"flex-1 pr-[10rpx]",style:y({opacity:"province"==A.value?1:0,pointerEvents:"province"==A.value?"auto":"none",height:"province"==A.value?"auto":"0",overflow:"province"==A.value?"auto":"hidden"})},{default:r(()=>[(l(!0),f(x,null,m(D.province,(t,e)=>(l(),s(i,{key:t.id,class:d(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":B.province&&B.province.id==t.id}]),onClick:e=>(t=>{B.province=t,w(()=>{Y()})})(t)},{default:r(()=>[n(p(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):u("v-if",!0),D.city.length?(l(),s(i,{key:1,class:"flex-1 pr-[10rpx]",style:y({opacity:"city"==A.value?1:0,pointerEvents:"city"==A.value?"auto":"none",height:"city"==A.value?"auto":"0",overflow:"city"==A.value?"auto":"hidden"})},{default:r(()=>[(l(!0),f(x,null,m(D.city,(t,e)=>(l(),s(i,{key:t.id,class:d(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":B.city&&B.city.id==t.id}]),onClick:e=>(t=>{B.city=t,w(()=>{Y()})})(t)},{default:r(()=>[n(p(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):u("v-if",!0),D.district.length?(l(),s(i,{key:2,class:"flex-1 pr-[10rpx]",style:y({opacity:"district"==A.value?1:0,pointerEvents:"district"==A.value?"auto":"none",height:"district"==A.value?"auto":"0",overflow:"district"==A.value?"auto":"hidden"})},{default:r(()=>[(l(!0),f(x,null,m(D.district,(t,e)=>(l(),s(i,{key:t.id,class:d(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":B.district&&B.district.id==t.id}]),onClick:e=>B.district=t},{default:r(()=>[n(p(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):(l(),s(i,{key:3,class:"flex-1 pr-[10rpx]"}))]),_:1})]),_:1},8,["scroll-top"])]),_:1})]),_:1},8,["show"])}}});export{I as _};
