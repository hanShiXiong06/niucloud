import{d as e,r as a,x as l,y as t,o,c as r,w as i,g as n,v as s,e as u,j as d,m as p,q as m,s as c,L as f,f as v,B as y,C as _,i as x,A as h,bV as b,E as g,z as k,bW as w,bo as j,k as C,l as S,K as z,I,p as V,S as q,bX as D,b as N}from"./index-0259f5df.js";import{_ as A}from"./u-avatar.bc708e92.js";import{_ as F}from"./u-upload.7e0cb1c9.js";import{_ as L,a as O}from"./u-cell-group.a569e447.js";import{_ as B}from"./u-popup.6f1fa414.js";import{_ as P}from"./u-action-sheet.81c10463.js";import{d as $,_ as E}from"./index.abe68e63.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.e993510c.js";import"./u-loading-icon.d4562dd7.js";import"./u-line.2127c15d.js";import"./u-transition.9813ca7a.js";import"./u-parse.43b08298.js";import"./top-tabbar.2760179d.js";import"./manifest.452e73d8.js";import"./diy_form.83647cbe.js";import"./u-checkbox-group.22792735.js";import"./area-select.vue_vue_type_script_setup_true_lang.57e94a11.js";import"./u-input.8fd8730e.js";const U=e({__name:"personal_form_detail",props:["data","completeLayout"],setup(e){const m=e,c=a(!0),f=l({global:{},value:[]});return t(()=>{f.global.completeLayout=m.completeLayout||"style-1",m.data.formField&&m.data.formField.forEach(e=>{let a={componentIsShow:!0,id:e.field_key,componentName:e.field_type,pageStyle:"",viewFormDetail:!0,isShowArrow:!0,field:{name:e.field_name,value:e.field_value,required:e.field_required,unique:e.field_unique,privacyProtection:e.privacy_protection},margin:{top:0,bottom:0,both:0}};try{a.field.value=JSON.parse(e.field_value),"FormNumber"!=a.componentName&&"FormIdentity"!=a.componentName||(a.field.value=String(e.field_value))}catch(l){a.field.value=e.field_value}f.value.push(a)}),c.value=!1}),(e,a)=>{const l=p;return o(),r(l,{style:d(e.themeColor()),class:"my-[var(--top-m)] sidebar-margin overflow-hidden card-template py-[12rpx] px-[26rpx]"},{default:i(()=>[n(u(l,{class:"diy-template-wrap"},{default:i(()=>[u($,{ref:"diyGroupRef",data:f},null,8,["data"])]),_:1},512),[[s,!c.value]])]),_:1},8,["style"])}}}),G=R(e({__name:"personal",setup(e){const t=m(),n=c(()=>t.info);a(null),f(()=>{});const s=l({modal:!1,value:n.nickname||""}),$=e=>{s.value=e.detail.value};let R=a(null);b().then(e=>{R.value=e.data});const G=()=>{uni.$u.test.isEmpty(s.value)?g({title:k("nicknamePlaceholder"),icon:"none"}):w({field:"nickname",value:s.value}).then(e=>{t.info.nickname=s.value,s.modal=!1})},J=a(!1),K=c(()=>[{name:k("man"),value:1},{name:k("woman"),value:2}]),M=e=>{w({field:"sex",value:e.value}).then(a=>{t.info.sex_name=e.name})},T=e=>{j({filePath:e.file.url,name:"file"}).then(e=>{w({field:"headimg",value:e.data.url}).then(()=>{t.info.headimg=e.data.url})}).catch(()=>{})},W=a(!1),X=e=>{w({field:"birthday",value:uni.$u.date(e.value,"yyyy-mm-dd")}).then(()=>{t.info.birthday=uni.$u.date(e.value||e.value+1,"yyyy-mm-dd"),W.value=!1})};return(e,a)=>{const l=C(S("u-avatar"),A),t=C(S("u-upload"),F),m=C(S("u-cell"),L),c=p,f=z,b=C(S("u-cell-group"),O),g=I,w=C(S("u-popup"),B),j=C(S("u-action-sheet"),P),H=C(S("u-datetime-picker"),E),Q=V("layout-default-uni");return o(),r(Q,null,{default:i(()=>[v(n)?(o(),r(c,{key:0,class:"w-full min-h-screen bg-page personal-wrap !pb-[20rpx] overflow-hidden",style:d(e.themeColor())},{default:i(()=>[u(c,{class:"my-[var(--top-m)] sidebar-margin overflow-hidden card-template py-[20rpx]"},{default:i(()=>[u(b,{border:!1,class:"cell-group"},{default:i(()=>{return[u(m,{title:v(k)("headimg"),titleStyle:{"font-size":"28rpx"},"is-link":!0},{value:i(()=>[u(t,{onAfterRead:T,maxCount:1},{default:i(()=>[u(l,{src:v(q)(v(n).headimg),"default-url":v(q)("static/resource/images/default_headimg.png"),size:"40",leftIcon:"none"},null,8,["src","default-url"])]),_:1})]),_:1},8,["title"]),u(m,{title:v(k)("nickname"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:v(n).nickname,onClick:a[0]||(a[0]=e=>s.modal=!0)},null,8,["title","value"]),u(m,{title:v(k)("sex"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:v(n).sex_name||v(k)("unknown"),onClick:a[1]||(a[1]=e=>J.value=!0)},null,8,["title","value"]),u(m,{title:v(k)("mobile"),titleStyle:{"font-size":"28rpx"}},{value:i(()=>[v(n).mobile?(o(),r(c,{key:0,class:"mr-[10rpx]"},{default:i(()=>[y(_(v(D)(v(n).mobile)),1)]),_:1})):(o(),r(c,{key:1},{default:i(()=>[u(f,{onClick:a[2]||(a[2]=e=>v(N)({url:"/app/pages/auth/bind"})),class:"bg-transparent w-[170rpx] p-[0] rounded-[100rpx] text-[var(--primary-color)] !border-[2rpx] !border-solid border-[var(--primary-color)] text-[24rpx] h-[54rpx] flex-center"},{default:i(()=>[y(_(v(k)("bindMobile")),1)]),_:1})]),_:1}))]),_:1},8,["title"]),u(m,{title:v(k)("birthday"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:(e=v(n).birthday,(e?uni.$u.date(new Date(e),"yyyy-mm-dd"):"")||v(k)("unknown")),onClick:a[3]||(a[3]=e=>W.value=!0)},null,8,["title","value"])];var e}),_:1})]),_:1}),x(" 商品的万能表单信息 "),u(c,{onClick:a[4]||(a[4]=e=>v(N)({url:"/app/pages/member/personal_form",param:{form_id:v(n).form_id,form_record_id:v(n).form_record_id}}))},{default:i(()=>[v(R)&&Object.keys(v(R)).length?(o(),r(U,{key:0,class:"personal-form",data:v(R),completeLayout:"style-2"},null,8,["data"])):x("v-if",!0)]),_:1}),x(" 修改昵称 "),u(w,{class:"popup-type",safeAreaInsetBottom:!1,round:"var(--rounded-big)",show:s.modal,mode:"center",onClose:a[7]||(a[7]=e=>s.modal=!1)},{default:i(()=>[u(c,{class:"w-[620rpx] popup-common pb-[40rpx]",onTouchmove:a[6]||(a[6]=h(()=>{},["prevent","stop"]))},{default:i(()=>[u(c,{class:"title !pt-[50rpx] !pb-[60rpx]"},{default:i(()=>[y(_(v(k)("updateNickname")),1)]),_:1}),u(c,{class:"mx-[50rpx] border-0 border-b border-[#eee] border-solid"},{default:i(()=>[u(g,{type:"nickname",class:"h-[88rpx] text-[26rpx]",modelValue:s.value,"onUpdate:modelValue":a[5]||(a[5]=e=>s.value=e),placeholder:v(k)("nicknamePlaceholder"),placeholderClass:"text-[26rpx] h-[88rpx] flex items-center",onBlur:$},null,8,["modelValue","placeholder"])]),_:1}),u(c,{class:"px-[60rpx] pt-[70rpx]"},{default:i(()=>[u(f,{"hover-class":"none",class:"primary-btn-bg text-[#fff] h-[80rpx] font-500 leading-[80rpx] rounded-[100rpx] text-[26rpx]",onClick:G},{default:i(()=>[y(_(v(k)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),x(" 修改性别 "),u(j,{actions:v(K),show:J.value,closeOnClickOverlay:!0,safeAreaInsetBottom:!0,onClose:a[8]||(a[8]=e=>J.value=!1),onSelect:M},null,8,["actions","show"]),x(" 修改生日 "),u(H,{modelValue:v(n).birthday,"onUpdate:modelValue":a[9]||(a[9]=e=>v(n).birthday=e),show:W.value,mode:"date","confirm-text":v(k)("confirm"),maxDate:(new Date).valueOf(),minDate:0,"cancel-text":v(k)("cancel"),onCancel:a[10]||(a[10]=e=>W.value=!1),onConfirm:X},null,8,["modelValue","show","confirm-text","maxDate","cancel-text"])]),_:1},8,["style"])):x("v-if",!0)]),_:1})}}}),[["__scopeId","data-v-ffdea4c5"]]);export{G as default};
