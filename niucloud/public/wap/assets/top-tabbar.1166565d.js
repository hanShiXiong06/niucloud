import{a as t,L as e,M as l,ak as a,bv as s,d as o,aX as n,s as i,$ as r,r as c,y as d,f as u,o as p,c as y,w as f,e as m,j as x,D as _,B as g,C as v,i as h,A as k,a0 as S,n as b,az as C,m as w,R as B,J as A,S as I,b3 as T}from"./index-5dd3a833.js";import{m as V}from"./manifest.bb26aff2.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";function j(o){const n=t();let i=o;1!=n.mapConfig.is_open&&(i=!1);const r=()=>{if(!i)return!1;uni.getStorageSync("manually_select_location_from_map")||l()&&n.mapConfig.is_open&&!uni.getStorageSync("location_address")&&a.init(()=>{a.getLocation(t=>{let e=t.latitude+","+t.longitude;c(e)})})},c=(t="")=>{if(!i)return!1;let e={latlng:""};e.latlng=t||n.diyAddressInfo.latitude+","+n.diyAddressInfo.longitude,s(e).then(t=>{if(t.data&&Object.keys(t.data).length){let l={},a=e.latlng.split(",");l.latitude=a[0],l.longitude=a[1],l.full_address=null!=t.data.province?t.data.province:"",l.full_address+=null!=t.data.city?t.data.city:"",l.full_address+=null!=t.data.district?t.data.district:"",l.full_address+=null!=t.data.community?t.data.community:"",l.province_id=t.data.province_id,l.province=t.data.province,l.city_id=t.data.city_id,l.city=t.data.city,l.district_id=t.data.district_id,l.district=t.data.district,l.community=t.data.community,l.formatted_addresses=t.data.formatted_addresses,n.setAddressInfo(l)}else n.setAddressInfo();setTimeout(()=>{uni.removeStorageSync("manually_select_location_from_map")},500)})},d=()=>{let t=uni.getStorageSync("location_address");if(t){const e=new Date;n.mapConfig.valid_time>0?t.is_expired=e.getTime()/1e3>t.valid_time:t.is_expired=!1}else t={is_expired:!1};return t};return{init:r,onLoad:(t="")=>{e(e=>{e&&e.latng&&c(e.latng),uni.removeStorageSync("manually_select_location_from_map"),"function"==typeof t&&t(e)})},refresh:()=>{if(!i)return!1;!uni.getStorageSync("manually_select_location_from_map")&&uni.getStorageSync("location_address")&&(d()&&!d().is_expired?n.setAddressInfo(uni.getStorageSync("location_address")):uni.removeStorageSync("location_address")),!uni.getStorageSync("manually_select_location_from_map")&&d()&&d().is_expired&&r()},reposition:()=>{if(!i)return!1;n.diyAddressInfo&&n.diyAddressInfo.latitude,n.diyAddressInfo&&n.diyAddressInfo.longitude,uni.setStorageSync("manually_select_location_from_map",!0);let t=location.origin+location.pathname;window.location.href="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl="+encodeURIComponent(t)+"&key="+V.h5.sdkConfigs.maps.qqmap.key+"&referer=myapp"}}}const R=z(o({__name:"top-tabbar",props:{data:{type:Object,default:{}},titleColor:{type:String,default:"#606266"},customBack:{type:Function,default:null},scrollBool:{type:[String,Number],default:-1},isBack:{type:Boolean,default:!0},isFill:{type:Boolean,default:!0}},setup(e,{expose:l}){const a=e,s=t();s.systemInfo.platform;const o=n(),V=i(()=>{let t=!0;return t=!o.imageAdsSameScreen&&a.isFill,t}),z=i(()=>a.data),R=i(()=>{if(a.data&&a.data.topStatusBar)return a.data.topStatusBar}),F=i(()=>{let t="";return D?(t+="padding-left: 30rpx;","style-1"==R.value.style&&(t+="padding-right:70rpx;")):("style-1"==R.value.style&&(t+="padding-right: 30rpx;"),t+="padding-left: 30rpx;"),t}),q=i(()=>{let t="";return t+="font-size: 28rpx;",t+=`color: ${L.value};`,"style-1"==R.value.style&&(t+=`text-align: ${R.value.textAlign};`),t}),L=i(()=>{let t="";return t=1==a.scrollBool?R.value.rollTextColor:R.value.textColor,t}),$=i(()=>{let t="";return t=1==a.scrollBool?R.value.rollBgColor:R.value.bgColor,t});let G=uni.getStorageSync("componentsScrollValGroup");if(G)G.TopTabbar=0,uni.setStorageSync("componentsScrollValGroup",G);else{let t={TopTabbar:0};uni.setStorageSync("componentsScrollValGroup",t)}let U=r();const D=i(()=>{let t=!1;return a.isBack&&U.length>1&&(t=!0),t}),H=()=>{D.value&&("function"==typeof a.customBack?a.customBack():S())},O=i(()=>"0px"),P=c(0),J=T();let M=!1;R.value&&"style-4"==R.value.style&&(M=!0);const N=j(M);N.onLoad(),N.init(),d(()=>{b(()=>{C().in(J).select(".ns-navbar-wrap .u-navbar .content-wrap").boundingClientRect(t=>{P.value=t?t.height:0,s.setTopTabbar({height:P.value}),o.$patch(t=>{t.topTabarHeight=P.value})}).exec()}),N.refresh()});return l({refresh:()=>{N.refresh()}}),(t,e)=>{const l=w,n=B,i=A;return"decorate"!=u(o).mode&&u(R)?(p(),y(l,{key:0,class:_(["ns-navbar-wrap",u(R).style])},{default:f(()=>[m(l,{class:_(["u-navbar z-100",{fixed:-1!=a.scrollBool,absolute:-1==a.scrollBool}]),style:x({backgroundColor:u($)})},{default:f(()=>[m(l,{class:"navbar-inner",style:x({width:"100%",height:P.value+"px"})},{default:f(()=>["style-1"==u(R).style?(p(),y(l,{key:0,class:_(["content-wrap",[u(R).textAlign]]),style:x(u(F))},{default:f(()=>[m(l,{class:_(["back-wrap -ml-[16rpx] text-[26px] nc-iconfont nc-icon-zuoV6xx",{"!text-transparent":!u(D)}]),style:x({color:u(L)}),onClick:H},null,8,["class","style"]),m(l,{class:"title-wrap",style:x(u(q))},{default:f(()=>[g(v(u(z).title),1)]),_:1},8,["style"])]),_:1},8,["class","style"])):h("v-if",!0),"style-2"==u(R).style?(p(),y(l,{key:1,class:"content-wrap",style:x(u(F)),onClick:e[0]||(e[0]=t=>u(o).toRedirect(u(R).link))},{default:f(()=>[m(l,{class:_(["back-wrap -ml-[16rpx] text-[26px] nc-iconfont nc-icon-zuoV6xx",{"!text-transparent":!u(D)}]),style:x({color:u(L)}),onClick:H},null,8,["style","class"]),m(l,{class:"title-wrap",style:x({color:u(R).textColor})},{default:f(()=>[m(l,null,{default:f(()=>[m(n,{src:u(I)(u(R).imgUrl),mode:"heightFix"},null,8,["src"])]),_:1}),m(l,{style:x({color:u(R).textColor})},{default:f(()=>[g(v(u(z).title),1)]),_:1},8,["style"])]),_:1},8,["style"])]),_:1},8,["style"])):h("v-if",!0),"style-3"==u(R).style?(p(),y(l,{key:2,style:x(u(F)),class:"content-wrap"},{default:f(()=>[u(D)?(p(),y(l,{key:0,class:_(["back-wrap -ml-[16rpx] text-[26px] nc-iconfont nc-icon-zuoV6xx",{"!text-transparent":!u(D)}]),style:x({color:u(L)}),onClick:H},null,8,["style","class"])):h("v-if",!0),m(l,{class:"title-wrap",onClick:e[1]||(e[1]=t=>u(o).toRedirect(u(R).link))},{default:f(()=>[m(n,{src:u(I)(u(R).imgUrl),mode:"heightFix"},null,8,["src"])]),_:1}),m(l,{class:"search",onClick:e[2]||(e[2]=t=>u(o).toRedirect(u(R).link)),style:x({height:u(s).menuButtonInfo.height-2+"px",lineHeight:u(s).menuButtonInfo.height-2+"px"})},{default:f(()=>[m(i,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[24rpx] absolute left-[20rpx]"}),m(i,{class:"text-[24rpx]"},{default:f(()=>[g(v(u(R).inputPlaceholder),1)]),_:1})]),_:1},8,["style"]),m(l,{style:x({width:u(O)})},null,8,["style"])]),_:1},8,["style"])):h("v-if",!0),"style-4"==u(R).style?(p(),y(l,{key:3,style:x(u(F)),class:"content-wrap"},{default:f(()=>[m(l,{class:_(["back-wrap -ml-[16rpx] text-[26px] nc-iconfont nc-icon-zuoV6xx",{"!text-transparent":!u(D)}]),style:x({color:u(L)}),onClick:H},null,8,["style","class"]),m(i,{class:"nc-iconfont nc-icon-dizhiguanliV6xx text-[28rpx]",style:x({color:u(R).textColor})},null,8,["style"]),u(s).diyAddressInfo?(p(),y(l,{key:0,class:"title-wrap",onClick:e[3]||(e[3]=k(t=>u(N).reposition(),["stop"])),style:x({color:u(R).textColor})},{default:f(()=>[g(v(u(s).diyAddressInfo.community),1)]),_:1},8,["style"])):(p(),y(l,{key:1,class:"title-wrap",onClick:e[4]||(e[4]=k(t=>u(N).reposition(),["stop"])),style:x({color:u(R).textColor})},{default:f(()=>[g(v(u(s).defaultPositionAddress),1)]),_:1},8,["style"])),m(i,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx]",onClick:e[5]||(e[5]=k(t=>u(N).reposition(),["stop"])),style:x({color:u(R).textColor})},null,8,["style"])]),_:1},8,["style"])):h("v-if",!0)]),_:1},8,["style"])]),_:1},8,["class","style"]),h(" 解决fixed定位后导航栏塌陷的问题 "),u(V)?(p(),y(l,{key:0,class:"u-navbar-placeholder",style:x({width:"100%",paddingTop:P.value+"px"})},null,8,["style"])):h("v-if",!0)]),_:1},8,["class"])):h("v-if",!0)}}}),[["__scopeId","data-v-05d4c06e"]]);export{R as _,j as u};
