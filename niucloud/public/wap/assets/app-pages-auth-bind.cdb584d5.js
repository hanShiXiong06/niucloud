import{d as e,a as t,s as a,q as r,r as l,x as o,L as s,z as n,o as i,c as u,w as p,e as d,B as c,C as m,f as g,A as b,i as x,j as f,F as _,X as h,b as y,H as v,m as k,k as S,l as j,J as C,K as T,p as V,T as w,t as F}from"./index-0259f5df.js";import{_ as O}from"./u-input.8fd8730e.js";import{_ as B,a as P}from"./u-form.acd3204a.js";import{_ as I}from"./sms-code.vue_vue_type_script_setup_true_lang.ce0a56c0.js";import{_ as z,a as q}from"./u-checkbox-group.22792735.js";import{t as A}from"./topTabbar.6a4f0c22.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.e993510c.js";import"./u-line.2127c15d.js";import"./u-modal.11814531.js";import"./u-loading-icon.d4562dd7.js";import"./u-popup.6f1fa414.js";import"./u-transition.9813ca7a.js";const U=M(e({__name:"bind",setup(e){const M=t();A().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a(()=>Object.keys(M.menuButtonInfo).length?w(Number(M.menuButtonInfo.height))+w(M.menuButtonInfo.top)+w(8)+"rpx":"auto");const U=r(),E=a(()=>U.info),L=a(()=>F().login),H=l(!1),J=l(!1),K=o({mobile:"",mobile_code:"",mobile_key:"",register_type:""}),N=l(!0);s(e=>{setTimeout(()=>{N.value=!1},800),e.register_type&&Object.assign(K,{register_type:e.register_type}),uni.getStorageSync("openid")&&Object.assign(K,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(K,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(K,{unionid:uni.getStorageSync("unionid")}),uni.getStorageSync("nickname")&&Object.assign(K,{nickname:uni.getStorageSync("nickname")}),uni.getStorageSync("avatar")&&Object.assign(K,{avatar:uni.getStorageSync("avatar")})});const R={mobile:[{type:"string",required:!0,message:n("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,t,a){/^1[3-9]\d{9}$/.test(t)?a():a(new Error("请输入正确的手机号"))},message:n("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:n("codePlaceholder"),trigger:["blur","change"]}},X=()=>{J.value=!J.value},$=l(null),D=()=>{$.value.validate().then(()=>{if(H.value)return;H.value=!0;(E.value?_:h)(K).then(e=>{E.value?(U.getMemberInfo(),y({url:"/app/pages/member/personal",mode:"redirectTo"})):(U.setToken(e.data.token),v().handleLoginBack())}).catch(()=>{H.value=!1})})};return(e,t)=>{const a=k,r=S(j("u-input"),O),l=S(j("u-form-item"),B),o=S(j("sms-code"),I),s=S(j("u-form"),P),_=S(j("u-checkbox"),z),h=S(j("u-checkbox-group"),q),v=C,w=T,F=V("layout-default-uni");return i(),u(F,null,{default:p(()=>[d(a,{class:"w-screen h-screen flex flex-col",style:f(e.themeColor())},{default:p(()=>[d(a,{class:"mx-[60rpx]"},{default:p(()=>[d(a,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:p(()=>[c(m(g(n)("bindMobile")),1)]),_:1}),d(a,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[24rpx] mb-[90rpx]"},{default:p(()=>[c(m(g(n)("bindMobileTip")),1)]),_:1}),d(s,{labelPosition:"left",model:K,errorType:"toast",rules:R,ref_key:"formRef",ref:$},{default:p(()=>[d(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6]"},{default:p(()=>[d(l,{label:"",prop:"mobile","border-bottom":!1},{default:p(()=>[d(r,{modelValue:K.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>K.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:g(n)("mobilePlaceholder"),class:"!bg-transparent",disabled:N.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])]),_:1})]),_:1}),d(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:p(()=>[d(l,{label:"",prop:"mobile_code","border-bottom":!1},{default:p(()=>[d(r,{modelValue:K.mobile_code,"onUpdate:modelValue":t[2]||(t[2]=e=>K.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:g(n)("codePlaceholder"),class:"!bg-transparent",disabled:N.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:p(()=>[d(o,{mobile:K.mobile,type:"bind_mobile",modelValue:K.mobile_key,"onUpdate:modelValue":t[1]||(t[1]=e=>K.mobile_key=e)},null,8,["mobile","modelValue"])]),_:1},8,["modelValue","placeholder","disabled"])]),_:1})]),_:1})]),_:1},8,["model"]),d(a,{class:"mt-[100rpx]"},{default:p(()=>[g(L).agreement_show?(i(),u(a,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:b(X,["stop"])},{default:p(()=>[d(h,{onChange:X},{default:p(()=>[d(_,{activeColor:"var(--primary-color)",checked:J.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])]),_:1}),d(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:p(()=>[d(v,null,{default:p(()=>[c(m(g(n)("agreeTips")),1)]),_:1}),d(v,{onClick:t[3]||(t[3]=b(e=>g(y)({url:"/app/pages/auth/agreement?key=privacy"}),["stop"])),class:"text-primary"},{default:p(()=>[c("《"+m(g(n)("privacyAgreement"))+"》",1)]),_:1}),d(v,null,{default:p(()=>[c(m(g(n)("and")),1)]),_:1}),d(v,{onClick:t[4]||(t[4]=b(e=>g(y)({url:"/app/pages/auth/agreement?key=service"}),["stop"])),class:"text-primary"},{default:p(()=>[c("《"+m(g(n)("userAgreement"))+"》",1)]),_:1})]),_:1})]),_:1},8,["onClick"])):x("v-if",!0),d(w,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:D},{default:p(()=>[c(m(g(n)("bind")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})}}}),[["__scopeId","data-v-ab60eb6d"]]);export{U as default};
