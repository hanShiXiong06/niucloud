import{d as t,r as e,x as i,bH as c,ag as a,bI as l,n as s,k as r,l as o,o as n,c as d,w as p,e as u,A as v,B as y,D as f,C as m,i as x,j as h,Y as k,Z as _,ac as g,m as C,aw as w}from"./index-0259f5df.js";import{_ as I}from"./u-popup.6f1fa414.js";const b=t({__name:"area-select",props:{areaId:{type:Number,default:0}},emits:["complete"],setup(t,{expose:b,emit:T}){const j=t,E=e(!1),A=i({province:[],city:[],district:[]}),B=e("province"),D=i({province:null,city:null,district:null}),H=e(0);c(0).then(({data:t})=>{A.province=t}).catch(),a(()=>j.areaId,(t,e)=>{t&&!e&&l(t).then(({data:t})=>{t.province&&(D.province=t.province),t.city&&(D.city=t.city),t.district&&(D.district=t.district)})},{immediate:!0}),a(()=>D.province,()=>{c(D.province.id).then(({data:t})=>{if(A.city=t,B.value="city",D.city){let e=!1,i=-1;for(let c=0;c<t.length;c++)if(D.city.id==t[c].id){e=!0,i=c;break}e?setTimeout(()=>{M("city",i)},100):D.city=null}}).catch()},{deep:!0}),a(()=>D.city,t=>{t?c(D.city.id).then(({data:t})=>{if(A.district=t,B.value="district",D.district){let e=!1,i=-1;for(let c=0;c<t.length;c++)if(D.district.id==t[c].id){e=!0,i=c;break}e?setTimeout(()=>{M("district",i)},100):D.district=null}t.length||(B.value="city",T("complete",D),E.value=!1)}).catch():(A.district=[],D.district=null)},{deep:!0});const M=(t,e)=>{const i=Math.max(0,40*(e-2));H.value=i},N=()=>{H.value=1,s(()=>{H.value=0})};a(()=>B.value,t=>{s(()=>{if("province"===t&&D.province){const t=A.province.findIndex(t=>t.id===D.province.id);t>=0&&M("province",t)}else if("city"===t&&D.city){const t=A.city.findIndex(t=>t.id===D.city.id);t>=0&&M("city",t)}else if("district"===t&&D.district){const t=A.district.findIndex(t=>t.id===D.district.id);t>=0&&M("district",t)}})},{immediate:!0}),a(()=>D.district,t=>{t&&(B.value="district",T("complete",D),E.value=!1)},{deep:!0});return b({open:()=>{E.value=!0,j.areaId&&(B.value="district")}}),(t,e)=>{const i=C,c=w,a=r(o("u-popup"),I);return n(),d(a,{show:E.value,onClose:e[5]||(e[5]=t=>E.value=!1),mode:"bottom",round:10},{default:p(()=>[u(i,{onTouchmove:e[4]||(e[4]=v(()=>{},["prevent","stop"])),class:"popup-common"},{default:p(()=>[u(i,{class:"title"},{default:p(()=>[y("请选择地区")]),_:1}),u(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500"},{default:p(()=>[A.province.length?(n(),d(i,{key:0,class:f(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"province"==B.value}]),onClick:e[0]||(e[0]=t=>B.value="province")},{default:p(()=>[D.province?(n(),d(i,{key:0},{default:p(()=>[y(m(D.province.name),1)]),_:1})):(n(),d(i,{key:1},{default:p(()=>[y("请选择")]),_:1}))]),_:1},8,["class"])):x("v-if",!0),A.city.length?(n(),d(i,{key:1,class:f(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"city"==B.value}]),onClick:e[1]||(e[1]=t=>B.value="city")},{default:p(()=>[D.city?(n(),d(i,{key:0},{default:p(()=>[y(m(D.city.name),1)]),_:1})):(n(),d(i,{key:1},{default:p(()=>[y("请选择")]),_:1}))]),_:1},8,["class"])):x("v-if",!0),A.district.length?(n(),d(i,{key:2,class:f(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"district"==B.value}]),onClick:e[2]||(e[2]=t=>B.value="district")},{default:p(()=>[D.district?(n(),d(i,{key:0},{default:p(()=>[y(m(D.district.name),1)]),_:1})):(n(),d(i,{key:1},{default:p(()=>[y("请选择")]),_:1}))]),_:1},8,["class"])):(n(),d(i,{key:3,class:"flex-1 pr-[10rpx]"}))]),_:1}),u(c,{"scroll-y":"true",class:"h-[700rpx] overflow-y-auto","scroll-top":H.value,"scroll-with-animation":"",onTouchmove:e[3]||(e[3]=v(()=>{},["stop"]))},{default:p(()=>[u(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500"},{default:p(()=>[A.province.length?(n(),d(i,{key:0,class:"flex-1 pr-[10rpx]",style:h({opacity:"province"==B.value?1:0,pointerEvents:"province"==B.value?"auto":"none",height:"province"==B.value?"auto":"0",overflow:"province"==B.value?"auto":"hidden"})},{default:p(()=>[(n(!0),k(_,null,g(A.province,(t,e)=>(n(),d(i,{key:t.id,class:f(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":D.province&&D.province.id==t.id}]),onClick:e=>(t=>{D.province=t,s(()=>{N()})})(t)},{default:p(()=>[y(m(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):x("v-if",!0),A.city.length?(n(),d(i,{key:1,class:"flex-1 pr-[10rpx]",style:h({opacity:"city"==B.value?1:0,pointerEvents:"city"==B.value?"auto":"none",height:"city"==B.value?"auto":"0",overflow:"city"==B.value?"auto":"hidden"})},{default:p(()=>[(n(!0),k(_,null,g(A.city,(t,e)=>(n(),d(i,{key:t.id,class:f(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":D.city&&D.city.id==t.id}]),onClick:e=>(t=>{D.city=t,s(()=>{N()})})(t)},{default:p(()=>[y(m(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):x("v-if",!0),A.district.length?(n(),d(i,{key:2,class:"flex-1 pr-[10rpx]",style:h({opacity:"district"==B.value?1:0,pointerEvents:"district"==B.value?"auto":"none",height:"district"==B.value?"auto":"0",overflow:"district"==B.value?"auto":"hidden"})},{default:p(()=>[(n(!0),k(_,null,g(A.district,(t,e)=>(n(),d(i,{key:t.id,class:f(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":D.district&&D.district.id==t.id}]),onClick:e=>D.district=t},{default:p(()=>[y(m(t.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"])):(n(),d(i,{key:3,class:"flex-1 pr-[10rpx]"}))]),_:1})]),_:1},8,["scroll-top"])]),_:1})]),_:1},8,["show"])}}});export{b as _};
