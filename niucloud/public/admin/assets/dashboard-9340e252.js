import{P as M,r as m,$ as R,d as Ye,R as Z,ax as H,aZ as Ne,o as je,h as C,c as B,a as o,e as a,w as i,u as e,dn as qe,t as T,F as me,W as pe,v as xe,bC as Qe,Y as ye,i as Ge,dY as _e,e4 as Ie,s as re,C as ie,dF as Ze,dq as we,e5 as he,e6 as He,dr as Xe,e7 as Je,e8 as Se,e9 as Ke,Z as le,dA as et,ea as tt,eb as at,ec as ot,ed as rt,a0 as lt,bV as nt,b0 as it,a4 as st,a1 as ct,aj as dt,ak as ut,b1 as mt,a3 as pt,p as yt,g as _t}from"./index-28ce54e5.js";/* empty css                   *//* empty css               *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                  */import{_ as E}from"./StatCard.vue_vue_type_script_setup_true_lang-d9b0b785.js";import{_ as $}from"./ChartCard.vue_vue_type_script_setup_true_lang-6f524a5f.js";import{_ as fe}from"./SectionHeader.vue_vue_type_script_setup_true_lang-46ec5d58.js";import{i as X,L as be}from"./index-8cd15ab6.js";import{_ as ht}from"./_plugin-vue_export-helper-c27b6911.js";function ft(l){return M.get("recycle/stats/getTodayStats",{params:l})}function bt(l){return M.get("recycle/stats/getUserStats",{params:l})}function gt(l){return M.get("recycle/stats/getOverviewStats",{params:l})}function vt(){return M.get("recycle/stats/getUserList")}function xt(l){return M.get("recycle/stats/getUserDetailStats",{params:l})}function wt(l){return M.get("recycle/stats/getMemberStatsOverview",{params:l})}function St(l){return M.get("recycle/stats/getMemberRegisterTrend",{params:l})}function kt(l){return M.get("recycle/stats/getMemberChannelStats",{params:l})}function Ct(l){return M.get("recycle/stats/getMemberInviteRank",{params:l})}function zt(l){return M.get("recycle/stats/getMemberActivityStats",{params:l})}function Lt(){const l=m("user"),b=m(""),V=m(0),p=m({start_time:"",end_time:""}),y=m({signed_order_count:0,signed_device_count:0,sign_category_breakdown:[],check_count:0,check_category_breakdown:[],price_count:0,price_category_breakdown:[],payment_count:0,payment_category_breakdown:[],recycle_count:0,return_count:0,total_amount:0}),S=m({today_order_count:0,yesterday_order_count:0,today_check_count:0,today_check_breakdown:[],today_payment_amount:0,today_payment_count:0,today_return_count:0}),x=m([]),w=m([]),r=m(!1),d=m({total_members:0,new_members:0,active_members:0,invite_members:0}),s=m([]),h=m([]),D=m([]),O=m([]),L=m(!1),J=async()=>{try{const t=await ft({});t.data&&(l.value=t.data.user_role||"user",b.value=t.data.user_name||"用户",V.value=t.data.user_id||0)}catch(t){console.error("获取用户角色失败",t)}},F=async()=>{try{const t={...p.value,user_id:V.value},u=await bt(t);if(u.data&&u.data.length>0){const n=u.data[0];y.value={signed_order_count:n.signed_order_count||0,signed_device_count:n.signed_device_count||0,sign_category_breakdown:n.sign_category_breakdown||[],check_count:n.check_count||0,check_category_breakdown:n.check_category_breakdown||[],price_count:n.price_count||0,price_category_breakdown:n.price_category_breakdown||[],payment_count:n.payment_count||0,payment_category_breakdown:n.payment_category_breakdown||[],recycle_count:n.recycle_count||0,return_count:n.return_count||0,total_amount:n.total_amount||0}}else y.value={signed_order_count:0,signed_device_count:0,sign_category_breakdown:[],check_count:0,check_category_breakdown:[],price_count:0,price_category_breakdown:[],payment_count:0,payment_category_breakdown:[],recycle_count:0,return_count:0,total_amount:0}}catch(t){console.error("获取用户工作统计失败",t),R.error("获取工作统计失败")}},W=async()=>{try{const t=await gt(p.value);S.value=t.data||{}}catch(t){console.error("获取概况统计失败",t),R.error("获取概况统计失败")}},Y=async()=>{try{const t=await vt();w.value=t.data||[]}catch(t){console.error("获取用户列表失败",t)}},N=async(t="")=>{r.value=!0;try{const u={...p.value,user_id:t},n=await xt(u);x.value=n.data||[]}catch(u){console.error("获取用户详细统计失败",u),R.error("获取用户统计失败")}finally{r.value=!1}},j=async()=>{L.value=!0;try{const t=await wt(p.value);d.value=t.data||{}}catch(t){console.error("获取会员统计概览失败",t),R.error("获取会员统计概览失败")}finally{L.value=!1}},q=async()=>{try{const t=await St(p.value);s.value=t.data||[]}catch(t){console.error("获取会员注册趋势失败",t),R.error("获取会员注册趋势失败")}},Q=async()=>{try{const t=await kt(p.value);h.value=t.data||[]}catch(t){console.error("获取会员渠道统计失败",t),R.error("获取会员渠道统计失败")}},K=async()=>{try{const t=await Ct(p.value);D.value=t.data||[]}catch(t){console.error("获取拉新排行榜失败",t),R.error("获取拉新排行榜失败")}},ee=async()=>{try{const t=await zt(p.value);O.value=t.data||[]}catch(t){console.error("获取会员活跃度统计失败",t),R.error("获取会员活跃度统计失败")}},te=async()=>{await Promise.all([j(),q(),Q(),K(),ee()])};return{userRole:l,currentUserName:b,currentUserId:V,queryParams:p,userWorkStats:y,overviewStats:S,userDetailStats:x,userList:w,userLoading:r,memberStatsOverview:d,memberRegisterTrend:s,memberChannelStats:h,memberInviteRank:D,memberActivityStats:O,memberLoading:L,fetchUserRole:J,fetchUserWorkStats:F,fetchOverviewStats:W,fetchUserList:Y,fetchUserDetailStats:N,fetchData:async()=>{await J(),l.value==="admin"?(await W(),await Y(),await N(),await te()):await F()},fetchMemberStatsOverview:j,fetchMemberRegisterTrend:q,fetchMemberChannelStats:Q,fetchMemberInviteRank:K,fetchMemberActivityStats:ee,fetchAllMemberStats:te}}function Et(){const l=m(),b=m(),V=m(),p=m(),y=m(),S=m();let x=null,w=null,r=null,d=null,s=null,h=null;return{userCategoryChart:l,adminUserChart:b,overviewRingChart:V,memberRegisterTrendChart:p,memberChannelChart:y,memberActivityChart:S,initUserCategoryChart:()=>{l.value&&(x=X(l.value))},updateUserCategoryChart:c=>{if(!x)return;if(!c||c.length===0){const n={title:{text:"设备分类分布",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"item",formatter:"暂无数据"},legend:{orient:"horizontal",bottom:"0",data:[]},series:[{name:"设备类型",type:"pie",radius:["30%","70%"],center:["50%","45%"],avoidLabelOverlap:!1,itemStyle:{color:"#E5E7EB"},label:{show:!0,formatter:"暂无数据",position:"center",fontSize:14,color:"#9CA3AF"},labelLine:{show:!1},data:[{value:1,name:"暂无数据",itemStyle:{color:"#E5E7EB"}}]}]};x.setOption(n,!0);return}const t=c.map((n,f)=>({value:n.count,name:n.category_name,itemStyle:{color:["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399","#13C2C2","#722ED1"][f%7]}})),u={title:{text:"设备分类分布",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}台 ({d}%)"},legend:{orient:"horizontal",bottom:"0"},series:[{name:"设备类型",type:"pie",radius:["30%","70%"],center:["50%","45%"],avoidLabelOverlap:!1,label:{show:!0,formatter:"{b}: {c}台"},labelLine:{show:!0},data:t}]};x.setOption(u)},initAdminUserChart:()=>{b.value&&(w=X(b.value))},updateAdminUserChart:c=>{if(!w)return;if(!c||c.length===0){const v={title:{text:"员工工作量对比",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:"30",data:["签收数量","质检数量","定价数量","打款数量"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{rotate:45,color:"#9CA3AF"},axisLine:{lineStyle:{color:"#E5E7EB"}}},yAxis:{type:"value",axisLabel:{color:"#9CA3AF"},axisLine:{lineStyle:{color:"#E5E7EB"}},splitLine:{lineStyle:{color:"#E5E7EB"}}},graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:14,fill:"#9CA3AF"}},series:[{name:"签收数量",type:"bar",data:[],itemStyle:{color:"#13C2C2"}},{name:"质检数量",type:"bar",data:[],itemStyle:{color:"#409EFF"}},{name:"定价数量",type:"bar",data:[],itemStyle:{color:"#67C23A"}},{name:"打款数量",type:"bar",data:[],itemStyle:{color:"#E6A23C"}}]};w.setOption(v,!0);return}const t=c.map(v=>v.user_name),u=c.map(v=>v.signed_device_count),n=c.map(v=>v.check_count),f=c.map(v=>v.price_count),g=c.map(v=>v.payment_count),P={title:{text:"员工工作量对比",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:"30"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t,axisLabel:{rotate:45}},yAxis:{type:"value"},series:[{name:"签收数量",type:"bar",data:u,itemStyle:{color:"#13C2C2"}},{name:"质检数量",type:"bar",data:n,itemStyle:{color:"#409EFF"}},{name:"定价数量",type:"bar",data:f,itemStyle:{color:"#67C23A"}},{name:"打款数量",type:"bar",data:g,itemStyle:{color:"#E6A23C"}}]};w.setOption(P)},initOverviewRingChart:()=>{V.value&&(r=X(V.value))},updateOverviewRingChart:c=>{if(!r)return;const t=[{value:c.today_order_count||0,name:"订单",itemStyle:{color:"#3B82F6"}},{value:c.today_check_count||0,name:"质检",itemStyle:{color:"#10B981"}},{value:c.today_payment_count||0,name:"打款",itemStyle:{color:"#F59E0B"}},{value:c.today_return_count||0,name:"退货",itemStyle:{color:"#EF4444"}}];if(!t.some(f=>f.value>0)){const f={title:{text:"业务分布",left:"center",top:"5%",textStyle:{fontSize:14,fontWeight:"bold",color:"#9CA3AF"}},tooltip:{trigger:"item",formatter:"暂无数据"},legend:{orient:"horizontal",bottom:"5%",left:"center",textStyle:{fontSize:12,color:"#9CA3AF"}},graphic:{type:"text",left:"center",top:"middle",style:{text:"暂无数据",fontSize:14,fill:"#9CA3AF"}},series:[{name:"业务类型",type:"pie",radius:["45%","70%"],center:["50%","50%"],avoidLabelOverlap:!1,label:{show:!1},labelLine:{show:!1},data:[{value:1,name:"订单",itemStyle:{color:"#E5E7EB"}},{value:1,name:"质检",itemStyle:{color:"#E5E7EB"}},{value:1,name:"打款",itemStyle:{color:"#E5E7EB"}},{value:1,name:"退货",itemStyle:{color:"#E5E7EB"}}]}]};r.setOption(f,!0);return}const n={title:{text:"业务分布",left:"center",top:"5%",textStyle:{fontSize:14,fontWeight:"bold",color:"#374151"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:"5%",left:"center",textStyle:{fontSize:12}},series:[{name:"业务类型",type:"pie",radius:["45%","70%"],center:["50%","50%"],avoidLabelOverlap:!0,label:{show:!0,position:"outside",formatter:`{b}
{c}`,fontSize:12},labelLine:{show:!0,length:10,length2:10},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:t}]};r.setOption(n)},initMemberRegisterTrendChart:()=>{p.value&&(d=X(p.value))},updateMemberRegisterTrendChart:c=>{if(!d)return;const t=c.map(f=>f.date),u=c.map(f=>f.count);Math.max(...u,0),Math.min(...u,0),u.length>0&&(u.reduce((f,g)=>f+g,0)/u.length).toFixed(1);const n={title:{text:"注册趋势",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"#e5e7eb",borderWidth:1,textStyle:{color:"#374151"},axisPointer:{type:"cross",crossStyle:{color:"#9ca3af"},lineStyle:{color:"#d1d5db",type:"dashed"}},formatter:f=>{const g=f[0];return`
            <div style="padding: 4px 8px;">
              <div style="font-weight: 600; margin-bottom: 4px;">${g.axisValue}</div>
              <div style="display: flex; align-items: center;">
                <span style="display: inline-block; width: 10px; height: 10px; background: ${g.color}; border-radius: 50%; margin-right: 6px;"></span>
                <span>${g.seriesName}：<strong style="font-size: 16px; color: #3B82F6;">${g.value}</strong> 人</span>
              </div>
            </div>
          `}},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t,axisLine:{lineStyle:{color:"#e5e7eb"}},axisLabel:{rotate:45,fontSize:11,color:"#6b7280",margin:10},axisTick:{show:!0,lineStyle:{color:"#e5e7eb"}},splitLine:{show:!0,lineStyle:{color:"#f3f4f6",type:"dashed"}}},yAxis:{type:"value",name:"注册数",nameTextStyle:{color:"#6b7280",fontSize:12,padding:[0,0,0,0]},minInterval:1,axisLine:{show:!0,lineStyle:{color:"#e5e7eb"}},axisLabel:{color:"#6b7280",fontSize:11,formatter:"{value} 人"},splitLine:{show:!0,lineStyle:{color:"#f3f4f6",type:"dashed"}}},series:[{name:"注册用户",type:"line",smooth:!0,symbol:"circle",symbolSize:8,showSymbol:!0,lineStyle:{width:3,color:"#3B82F6",shadowColor:"rgba(59, 130, 246, 0.3)",shadowBlur:10,shadowOffsetY:5},areaStyle:{color:new be(0,0,0,1,[{offset:0,color:"rgba(59, 130, 246, 0.4)"},{offset:1,color:"rgba(59, 130, 246, 0.05)"}])},itemStyle:{color:"#3B82F6",borderWidth:2,borderColor:"#fff",shadowColor:"rgba(59, 130, 246, 0.5)",shadowBlur:8},emphasis:{focus:"series",itemStyle:{color:"#2563eb",borderWidth:3,shadowBlur:15,symbolSize:12}},label:{show:!0,position:"top",color:"#374151",fontSize:10,fontWeight:600,formatter:"{c}",distance:8},markPoint:{symbol:"pin",symbolSize:50,itemStyle:{color:"#ef4444"},data:[{type:"max",name:"最大值",label:{fontSize:11}},{type:"min",name:"最小值",label:{fontSize:11},itemStyle:{color:"#10b981"}}]},markLine:{silent:!0,lineStyle:{color:"#f59e0b",type:"dashed",width:1},label:{formatter:"平均: {c} 人",fontSize:11,color:"#f59e0b"},data:[{type:"average",name:"平均值"}]},data:u}]};d.setOption(n,!0)},initMemberChannelChart:()=>{y.value&&(s=X(y.value))},updateMemberChannelChart:c=>{if(!s)return;const t=c.map((n,f)=>({value:n.count,name:n.channel_name,itemStyle:{color:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4"][f%7]}})),u={title:{text:"注册渠道",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"10",top:"center",textStyle:{fontSize:12}},series:[{name:"注册渠道",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,label:{show:!0,formatter:`{b}
{c}人`,fontSize:11},labelLine:{show:!0,length:10,length2:5},data:t}]};s.setOption(u,!0)},initMemberActivityChart:()=>{S.value&&(h=X(S.value))},updateMemberActivityChart:c=>{if(!h)return;const t=c.map(g=>g.date),u=c.map(g=>g.active_count),n=c.map(g=>g.new_count),f={title:{text:"活跃度统计",left:"center",textStyle:{fontSize:14,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"#e5e7eb",borderWidth:1,textStyle:{color:"#374151"},axisPointer:{type:"cross",crossStyle:{color:"#9ca3af"},lineStyle:{color:"#d1d5db",type:"dashed"}},formatter:g=>{let P=`<div style="padding: 6px 10px;">
            <div style="font-weight: 600; margin-bottom: 6px; font-size: 13px;">${g[0].axisValue}</div>`;return g.forEach(v=>{P+=`
              <div style="display: flex; align-items: center; margin-bottom: 4px;">
                <span style="display: inline-block; width: 10px; height: 10px; background: ${v.color}; border-radius: 50%; margin-right: 8px;"></span>
                <span style="flex: 1;">${v.seriesName}：</span>
                <strong style="font-size: 15px; margin-left: 8px;" 
                        style="color: ${v.color};">${v.value}</strong>
                <span style="margin-left: 2px; color: #9ca3af;">人</span>
              </div>
            `}),P+="</div>",P}},legend:{data:["活跃用户","新增用户"],top:"8%",right:"10%",itemWidth:20,itemHeight:12,textStyle:{fontSize:12,color:"#6b7280"},icon:"roundRect"},grid:{left:"3%",right:"4%",bottom:"10%",top:"20%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t,axisLine:{lineStyle:{color:"#e5e7eb"}},axisLabel:{rotate:45,fontSize:11,color:"#6b7280",margin:10},axisTick:{show:!0,lineStyle:{color:"#e5e7eb"}},splitLine:{show:!0,lineStyle:{color:"#f3f4f6",type:"dashed"}}},yAxis:{type:"value",name:"用户数",nameTextStyle:{color:"#6b7280",fontSize:12,padding:[0,0,0,0]},minInterval:1,axisLine:{show:!0,lineStyle:{color:"#e5e7eb"}},axisLabel:{color:"#6b7280",fontSize:11,formatter:"{value} 人"},splitLine:{show:!0,lineStyle:{color:"#f3f4f6",type:"dashed"}}},series:[{name:"活跃用户",type:"line",smooth:!0,symbol:"circle",symbolSize:8,showSymbol:!0,lineStyle:{width:3,color:"#10B981",shadowColor:"rgba(16, 185, 129, 0.3)",shadowBlur:10,shadowOffsetY:5},areaStyle:{color:new be(0,0,0,1,[{offset:0,color:"rgba(16, 185, 129, 0.4)"},{offset:1,color:"rgba(16, 185, 129, 0.05)"}])},itemStyle:{color:"#10B981",borderWidth:2,borderColor:"#fff",shadowColor:"rgba(16, 185, 129, 0.5)",shadowBlur:8},emphasis:{focus:"series",itemStyle:{color:"#059669",borderWidth:3,shadowBlur:15,symbolSize:12}},label:{show:!0,position:"top",color:"#10B981",fontSize:10,fontWeight:600,formatter:"{c}",distance:5},markPoint:{symbol:"pin",symbolSize:45,itemStyle:{color:"#10B981"},data:[{type:"max",name:"峰值",label:{fontSize:10}}]},markLine:{silent:!0,lineStyle:{color:"#10B981",type:"dashed",width:1,opacity:.6},label:{formatter:"活跃平均: {c}",fontSize:10,color:"#10B981"},data:[{type:"average",name:"平均值"}]},data:u},{name:"新增用户",type:"line",smooth:!0,symbol:"circle",symbolSize:8,showSymbol:!0,lineStyle:{width:3,color:"#3B82F6",shadowColor:"rgba(59, 130, 246, 0.3)",shadowBlur:10,shadowOffsetY:5},areaStyle:{color:new be(0,0,0,1,[{offset:0,color:"rgba(59, 130, 246, 0.4)"},{offset:1,color:"rgba(59, 130, 246, 0.05)"}])},itemStyle:{color:"#3B82F6",borderWidth:2,borderColor:"#fff",shadowColor:"rgba(59, 130, 246, 0.5)",shadowBlur:8},emphasis:{focus:"series",itemStyle:{color:"#2563eb",borderWidth:3,shadowBlur:15,symbolSize:12}},label:{show:!0,position:"bottom",color:"#3B82F6",fontSize:10,fontWeight:600,formatter:"{c}",distance:5},markPoint:{symbol:"pin",symbolSize:45,itemStyle:{color:"#3B82F6"},data:[{type:"max",name:"峰值",label:{fontSize:10}}]},markLine:{silent:!0,lineStyle:{color:"#3B82F6",type:"dashed",width:1,opacity:.6},label:{formatter:"新增平均: {c}",fontSize:10,color:"#3B82F6"},data:[{type:"average",name:"平均值"}]},data:n}]};h.setOption(f,!0)},handleResize:()=>{x==null||x.resize(),w==null||w.resize(),r==null||r.resize(),d==null||d.resize(),s==null||s.resize(),h==null||h.resize()},disposeCharts:()=>{x==null||x.dispose(),w==null||w.dispose(),r==null||r.dispose(),d==null||d.dispose(),s==null||s.dispose(),h==null||h.dispose()}}}function Vt(){const l=m([]),b=m("today"),V=m([{key:"today",label:"今日"},{key:"week",label:"本周"},{key:"month",label:"本月"},{key:"custom",label:"自定义"}]),p=r=>r.toISOString().split("T")[0];return{dateRange:l,activePeriod:b,quickPeriods:V,handleQuickPeriod:(r,d)=>{b.value=r;const s=new Date;let h,D=s;switch(r){case"today":h=s,D=s;break;case"week":h=new Date(s),h.setDate(s.getDate()-s.getDay());break;case"month":h=new Date(s.getFullYear(),s.getMonth(),1);break;case"custom":return;default:h=s}if(r!=="custom"){const O=p(h),L=p(D);l.value=[O,L],d(O,L)}},handleDateChange:(r,d)=>{r&&r.length===2?(b.value="custom",d(r[0],r[1])):d("","")},getTimePeriodText:(r,d)=>r&&d?r===d?r:`${r} 至 ${d}`:"今日",getPeriodLabel:r=>{const s={order:{week:"本周订单",month:"本月订单",default:"今日订单"},check:{week:"本周质检",month:"本月质检",default:"今日质检"},payment:{week:"本周打款",month:"本月打款",default:"今日打款"},return:{week:"本周退货",month:"本月退货",default:"今日退货"}}[r];switch(b.value){case"week":return s.week;case"month":return s.month;default:return s.default}}}}const se=l=>(yt("data-v-0b7483d7"),l=l(),_t(),l),Bt={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50"},At={class:"bg-white shadow-sm border-b border-gray-100 sticky top-0 z-10"},Mt={class:"mx-auto px-4 sm:px-6 lg:px-8 py-4"},Dt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},Ft={class:"flex items-center space-x-3"},Ot={class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center"},Rt=se(()=>o("h1",{class:"text-xl font-semibold text-gray-900"},"数据概览",-1)),Pt={class:"text-sm text-gray-500"},Ut={class:"flex flex-wrap items-center gap-3"},Tt={class:"flex bg-gray-100 rounded-lg p-1"},$t=["onClick"],Wt={class:"flex items-center gap-2"},Yt={class:"mx-auto px-4 sm:px-6 lg:px-8 py-6"},Nt={key:0,class:"space-y-6"},jt={class:"text-right"},qt=se(()=>o("div",{class:"text-white/80 text-xs"},"总计设备",-1)),Qt={class:"text-white text-xl font-bold"},Gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-2"},It={key:1,class:"space-y-6"},Zt={class:"space-y-4"},Ht={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Xt={class:"h-full flex flex-col bg-white rounded-lg"},Jt={class:"flex items-center gap-2"},Kt=se(()=>o("span",{class:"text-xs text-gray-600 whitespace-nowrap"},"员工筛选：",-1)),ea={class:"w-full"},ta={class:"space-y-4"},aa={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},oa={class:"w-full h-80 overflow-y-auto"},ra={key:0,class:"flex items-center justify-center h-full text-gray-400"},la={key:1,class:"space-y-2 p-2"},na={class:"flex items-center gap-3"},ia={class:"text-sm font-medium text-gray-900"},sa={class:"text-xs text-gray-500"},ca={class:"text-right"},da={class:"text-lg font-bold text-blue-600"},ua=se(()=>o("div",{class:"text-xs text-gray-500"},"人",-1)),ma=Ye({__name:"dashboard",setup(l){const{userRole:b,currentUserName:V,queryParams:p,userWorkStats:y,overviewStats:S,userDetailStats:x,userList:w,userLoading:r,memberStatsOverview:d,memberRegisterTrend:s,memberChannelStats:h,memberInviteRank:D,memberActivityStats:O,memberLoading:L,fetchUserDetailStats:J,fetchData:F}=Lt(),{userCategoryChart:W,adminUserChart:Y,overviewRingChart:N,memberRegisterTrendChart:j,memberChannelChart:q,memberActivityChart:Q,initUserCategoryChart:K,updateUserCategoryChart:ee,initAdminUserChart:te,updateAdminUserChart:c,initOverviewRingChart:t,updateOverviewRingChart:u,initMemberRegisterTrendChart:n,updateMemberRegisterTrendChart:f,initMemberChannelChart:g,updateMemberChannelChart:P,initMemberActivityChart:v,updateMemberActivityChart:ke,handleResize:ge,disposeCharts:Ce}=Et(),{dateRange:ce,activePeriod:ze,quickPeriods:Le,handleQuickPeriod:Ee,handleDateChange:Ve,getTimePeriodText:Be,getPeriodLabel:ne}=Vt(),de=m(""),Ae=k=>{Ee(k,(A,G)=>{p.value.start_time=A,p.value.end_time=G,F()})},Me=k=>{Ve(k,(A,G)=>{p.value.start_time=A,p.value.end_time=G,F()})},ue=()=>Be(p.value.start_time,p.value.end_time),De=()=>{J(de.value)},Fe=()=>(y.value.signed_device_count||0)+(y.value.check_count||0)+(y.value.price_count||0)+(y.value.payment_count||0),Oe=()=>ne("order"),Re=()=>ne("check"),Pe=()=>ne("payment"),Ue=()=>ne("return");return Z(()=>y.value.sign_category_breakdown,k=>{H(()=>{W.value&&(K(),ee(k||[]))})},{deep:!0,immediate:!0}),Z(()=>x.value,k=>{H(()=>{Y.value&&(te(),c(k||[]))})},{deep:!0,immediate:!0}),Z(()=>S.value,k=>{H(()=>{N.value&&(t(),u(k||{}))})},{deep:!0,immediate:!0}),Z(()=>s.value,k=>{H(()=>{j.value&&(n(),f(k||[]))})},{deep:!0,immediate:!0}),Z(()=>h.value,k=>{H(()=>{q.value&&(g(),P(k||[]))})},{deep:!0,immediate:!0}),Z(()=>O.value,k=>{H(()=>{Q.value&&(v(),ke(k||[]))})},{deep:!0,immediate:!0}),Ne(()=>{F(),window.addEventListener("resize",ge)}),je(()=>{window.removeEventListener("resize",ge),Ce()}),(k,A)=>{const G=lt,Te=nt,z=it,ve=st,$e=ct,U=dt,We=ut,I=mt,ae=pt;return C(),B("div",Bt,[o("div",At,[o("div",Mt,[o("div",Dt,[o("div",Ft,[o("div",Ot,[a(G,{size:18,color:"white"},{default:i(()=>[a(e(qe))]),_:1})]),o("div",null,[Rt,o("p",Pt,T(e(b)==="admin"?"管理员控制台":"工作台数据"),1)])]),o("div",Ut,[o("div",Tt,[(C(!0),B(me,null,pe(e(Le),_=>(C(),B("button",{key:_.key,onClick:oe=>Ae(_.key),class:xe(["px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",e(ze)===_.key?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-blue-600 hover:bg-white/50"])},T(_.label),11,$t))),128))]),o("div",Wt,[a(Te,{modelValue:e(ce),"onUpdate:modelValue":A[0]||(A[0]=_=>Qe(ce)?ce.value=_:null),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:Me,size:"default",class:"custom-date-picker"},null,8,["modelValue"]),o("button",{onClick:A[1]||(A[1]=(..._)=>e(F)&&e(F)(..._)),class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 shadow-sm"},[a(G,{size:14,color:"white",class:"mr-1"},{default:i(()=>[a(e(ye))]),_:1}),Ge(" 查询 ")])])])])])]),o("div",Yt,[e(b)==="user"||e(b)==="checker"||e(b)==="pricer"?(C(),B("div",Nt,[a(fe,{title:e(V),subtitle:`${ue()} 工作概览`,icon:e(_e)},{right:i(()=>[o("div",jt,[qt,o("div",Qt,T(Fe()),1)])]),_:1},8,["title","subtitle","icon"]),o("div",Gt,[a(E,{title:"签收订单",mainValue:e(y).signed_order_count||0,subValue:`${e(y).signed_device_count||0} 台`,color:"blue",icon:e(Ie),showIndicator:!0},null,8,["mainValue","subValue","icon"]),e(y).check_count>0||["checker","admin"].includes(e(b))?(C(),re(E,{key:0,title:"质检设备",mainValue:e(y).check_count||0,subValue:"已质检",color:"green",icon:e(ye),showIndicator:!0},null,8,["mainValue","icon"])):ie("",!0),e(y).price_count>0||["pricer","admin"].includes(e(b))?(C(),re(E,{key:1,title:"定价设备",mainValue:e(y).price_count||0,subValue:`¥${e(y).total_amount||0}`,color:"orange",icon:e(Ze),showIndicator:!0},null,8,["mainValue","subValue","icon"])):ie("",!0),e(y).payment_count>0||["pricer","admin"].includes(e(b))?(C(),re(E,{key:2,title:"打款设备",mainValue:e(y).payment_count||0,subValue:"已打款",color:"red",icon:e(we),showIndicator:!0},null,8,["mainValue","icon"])):ie("",!0)]),a($,{title:"设备分类分布",icon:e(he)},{default:i(()=>[o("div",{ref_key:"userCategoryChart",ref:W,class:"w-full h-80"},null,512)]),_:1},8,["icon"])])):e(b)==="admin"?(C(),B("div",It,[a(I,{gutter:"16"},{default:i(()=>[a(z,{span:12},{default:i(()=>[o("div",Zt,[a(fe,{title:"运营概览",subtitle:`${ue()} 业务数据`,icon:e(He),bgClass:"bg-gradient-to-r from-blue-400 to-blue-500"},null,8,["subtitle","icon"]),a(I,{gutter:16},{default:i(()=>[a(z,{span:24},{default:i(()=>[o("div",Ht,[a(E,{title:Oe(),mainValue:e(S).today_order_count||0,subValue:`昨日 ${e(S).yesterday_order_count||0}`,color:"blue",link:"/recycle_order/list",icon:e(Xe)},null,8,["title","mainValue","subValue","icon"]),a(E,{title:Re(),mainValue:e(S).today_check_count||0,color:"green",link:"/recycle_order/list",icon:e(ye),extraInfo:(e(S).today_check_breakdown||[]).slice(0,2).map(_=>`${_.category_name} ${_.count}`)},null,8,["title","mainValue","icon","extraInfo"]),a(E,{title:Pe(),mainValue:`¥${e(S).today_payment_amount||0}`,subValue:`${e(S).today_payment_count||0} 台`,color:"orange",link:"/recycle_order/list",icon:e(we)},null,8,["title","mainValue","subValue","icon"]),a(E,{title:Ue(),mainValue:e(S).today_return_count||0,subValue:"设备数量",link:"/recycle_return_order/list",color:"red",icon:e(Je)},null,8,["title","mainValue","icon"])])]),_:1}),a(z,{span:12},{default:i(()=>[a($,{title:"业务分布",icon:e(he),contentClass:"py-2 ",class:"mt-4"},{default:i(()=>[o("div",{ref_key:"overviewRingChart",ref:N,class:"w-full h-80"},null,512)]),_:1},8,["icon"])]),_:1}),a(z,{span:12,class:"mt-4"},{default:i(()=>[o("div",Xt,[o("div",{ref_key:"adminUserChart",ref:Y,class:"flex-1 min-h-[380px]"},null,512)])]),_:1}),a(z,{xs:24,lg:24,class:"mt-4"},{default:i(()=>[a($,{title:"员工工作统计",icon:e(Se)},Ke({default:i(()=>[a(I,{gutter:16},{default:i(()=>[a(z,{xs:24,lg:24},{default:i(()=>[o("div",ea,[le((C(),re(We,{data:e(x),size:"small",class:"w-full min-h-[293px]"},{default:i(()=>[a(U,{prop:"user_name",label:"员工",fixed:""}),a(U,{prop:"user_type_name",label:"角色"}),a(U,{prop:"signed_order_count",label:"签收单"}),a(U,{prop:"signed_device_count",label:"签收台"}),a(U,{prop:"check_count",label:"质检"}),a(U,{prop:"price_count",label:"定价"}),a(U,{prop:"payment_count",label:"打款"})]),_:1},8,["data"])),[[ae,e(r)]])])]),_:1})]),_:1})]),_:2},[e(w).length>0?{name:"header-right",fn:i(()=>[o("div",Jt,[Kt,a($e,{modelValue:de.value,"onUpdate:modelValue":A[2]||(A[2]=_=>de.value=_),placeholder:"全部员工",clearable:"",onChange:De},{default:i(()=>[a(ve,{label:"全部员工",value:""}),(C(!0),B(me,null,pe(e(w),_=>(C(),re(ve,{key:_.uid,label:_.real_name||_.username,value:String(_.uid)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1032,["icon"])]),_:1})]),_:1})])]),_:1}),a(z,{span:12},{default:i(()=>[o("div",ta,[a(fe,{title:"会员统计",subtitle:`${ue()} 用户数据`,icon:e(_e),bgClass:"bg-gradient-to-r from-purple-500 to-pink-500"},null,8,["subtitle","icon"]),o("div",aa,[a(E,{title:"总用户数",mainValue:e(d).total_members||0,subValue:"注册用户",color:"purple",icon:e(_e)},null,8,["mainValue","icon"]),a(E,{title:"新增用户",mainValue:e(d).new_members||0,subValue:"期间注册",color:"blue",icon:e(Se)},null,8,["mainValue","icon"]),a(E,{title:"活跃用户",mainValue:e(d).active_members||0,subValue:"期间活跃",color:"green",icon:e(et)},null,8,["mainValue","icon"]),a(E,{title:"拉新用户",mainValue:e(d).invite_members||0,subValue:"被推广注册",color:"orange",icon:e(tt)},null,8,["mainValue","icon"])]),a(I,{gutter:16},{default:i(()=>[a(z,{xs:24,lg:16},{default:i(()=>[a(I,{gutter:16},{default:i(()=>[a(z,{span:24},{default:i(()=>[a($,{title:"注册趋势",icon:e(at),contentClass:"py-2"},{default:i(()=>[le(o("div",{ref_key:"memberRegisterTrendChart",ref:j,class:"w-full h-80"},null,512),[[ae,e(L)]])]),_:1},8,["icon"])]),_:1}),a(z,{span:24,class:"mt-4"},{default:i(()=>[a($,{title:"用户活跃度",icon:e(ot),contentClass:"py-2"},{default:i(()=>[le(o("div",{ref_key:"memberActivityChart",ref:Q,class:"w-full h-80"},null,512),[[ae,e(L)]])]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1}),a(z,{xs:24,lg:8},{default:i(()=>[a(I,{gutter:16},{default:i(()=>[a(z,{span:24},{default:i(()=>[a($,{title:"注册渠道",icon:e(he),contentClass:"py-2"},{default:i(()=>[le(o("div",{ref_key:"memberChannelChart",ref:q,class:"w-full h-80"},null,512),[[ae,e(L)]])]),_:1},8,["icon"])]),_:1}),a(z,{span:24,class:"mt-4"},{default:i(()=>[a($,{title:"拉新排行榜 TOP10",icon:e(rt),contentClass:"py-2"},{default:i(()=>[le((C(),B("div",oa,[e(D).length===0?(C(),B("div",ra," 暂无数据 ")):(C(),B("div",la,[(C(!0),B(me,null,pe(e(D),(_,oe)=>(C(),B("div",{key:_.member_id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[o("div",na,[o("div",{class:xe(["w-7 h-7 flex items-center justify-center rounded-full text-sm font-bold",oe===0?"bg-yellow-400 text-white":oe===1?"bg-gray-300 text-white":oe===2?"bg-orange-400 text-white":"bg-blue-100 text-blue-600"])},T(oe+1),3),o("div",null,[o("div",ia,T(_.nickname),1),o("div",sa,T(_.mobile),1)])]),o("div",ca,[o("div",da,T(_.invite_count),1),ua])]))),128))]))])),[[ae,e(L)]])]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})])):ie("",!0)])])}}});const Da=ht(ma,[["__scopeId","data-v-0b7483d7"]]);export{Da as default};
