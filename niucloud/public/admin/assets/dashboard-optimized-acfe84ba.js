import{d as me,r as pe,R as L,ax as S,aZ as he,o as ge,h as l,c as h,a,e as t,w as i,u as e,dn as fe,t as V,F as T,W as Y,v as be,bC as xe,Y as C,i as ve,dZ as ye,e5 as we,s as f,C as v,dF as ke,dq as B,e6 as Ve,e7 as Ce,dr as De,e8 as ze,Z as Ue,e9 as $e,a0 as Ie,bV as Pe,a4 as Ee,a1 as Le,aj as Se,ak as Te,b0 as Ye,b1 as Be,a3 as Re,p as Fe,g as Me}from"./index-9cfed1fc.js";/* empty css                   *//* empty css               *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                  */import{_ as d}from"./StatCard.vue_vue_type_script_setup_true_lang-79a7caf7.js";import{_ as R}from"./ChartCard.vue_vue_type_script_setup_true_lang-ecf5c351.js";import{_ as F}from"./SectionHeader.vue_vue_type_script_setup_true_lang-23806d8b.js";import{u as Ne,a as Oe,b as je}from"./useDateFilter-9647fe63.js";import{_ as qe}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-8cd15ab6.js";const y=b=>(Fe("data-v-d6df18d2"),b=b(),Me(),b),Qe={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50"},Ze={class:"bg-white shadow-sm border-b border-gray-100 sticky top-0 z-10"},Ae={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},We={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},Ge={class:"flex items-center space-x-3"},He={class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center"},Je=y(()=>a("h1",{class:"text-xl font-semibold text-gray-900"},"数据概览",-1)),Ke={class:"text-sm text-gray-500"},Xe={class:"flex flex-wrap items-center gap-3"},et={class:"flex bg-gray-100 rounded-lg p-1"},tt=["onClick"],at={class:"flex items-center gap-2"},ot={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},st={key:0,class:"space-y-6"},lt={class:"text-right"},it=y(()=>a("div",{class:"text-white/80 text-xs"},"总计设备",-1)),nt={class:"text-white text-xl font-bold"},rt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ct={key:1,class:"space-y-6"},dt={class:"space-y-4"},ut={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},_t={class:"flex items-center gap-2"},mt=y(()=>a("span",{class:"text-xs text-gray-600 whitespace-nowrap"},"员工筛选：",-1)),pt={class:"overflow-x-auto"},ht={class:"h-full flex flex-col"},gt=y(()=>a("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"工作量对比",-1)),ft=me({__name:"dashboard-optimized",setup(b){const{userRole:r,currentUserName:M,queryParams:m,userWorkStats:s,overviewStats:u,userDetailStats:D,userList:N,userLoading:O,fetchUserDetailStats:j,fetchData:g}=Ne(),{userCategoryChart:z,adminUserChart:U,initUserCategoryChart:q,updateUserCategoryChart:Q,initAdminUserChart:Z,updateAdminUserChart:A,handleResize:$,disposeCharts:W}=Oe(),{dateRange:w,activePeriod:G,quickPeriods:H,handleQuickPeriod:J,handleDateChange:K,getTimePeriodText:X,getPeriodLabel:x}=je(),k=pe(""),ee=c=>{J(c,(n,p)=>{m.value.start_time=n,m.value.end_time=p,g()})},te=c=>{K(c,(n,p)=>{m.value.start_time=n,m.value.end_time=p,g()})},I=()=>X(m.value.start_time,m.value.end_time),ae=()=>{j(k.value)},oe=()=>(s.value.signed_device_count||0)+(s.value.check_count||0)+(s.value.price_count||0)+(s.value.payment_count||0),se=()=>x("order"),le=()=>x("check"),ie=()=>x("payment"),ne=()=>x("return");return L(()=>s.value.sign_category_breakdown,c=>{S(()=>{z.value&&(q(),Q(c||[]))})},{deep:!0,immediate:!0}),L(()=>D.value,c=>{S(()=>{U.value&&(Z(),A(c||[]))})},{deep:!0,immediate:!0}),he(()=>{g(),window.addEventListener("resize",$)}),ge(()=>{window.removeEventListener("resize",$),W()}),(c,n)=>{const p=Ie,re=Pe,P=Ee,ce=Le,_=Se,de=Te,E=Ye,ue=Be,_e=Re;return l(),h("div",Qe,[a("div",Ze,[a("div",Ae,[a("div",We,[a("div",Ge,[a("div",He,[t(p,{size:18,color:"white"},{default:i(()=>[t(e(fe))]),_:1})]),a("div",null,[Je,a("p",Ke,V(e(r)==="admin"?"管理员控制台":"工作台数据"),1)])]),a("div",Xe,[a("div",et,[(l(!0),h(T,null,Y(e(H),o=>(l(),h("button",{key:o.key,onClick:bt=>ee(o.key),class:be(["px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",e(G)===o.key?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-blue-600 hover:bg-white/50"])},V(o.label),11,tt))),128))]),a("div",at,[t(re,{modelValue:e(w),"onUpdate:modelValue":n[0]||(n[0]=o=>xe(w)?w.value=o:null),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:te,size:"default",class:"custom-date-picker"},null,8,["modelValue"]),a("button",{onClick:n[1]||(n[1]=(...o)=>e(g)&&e(g)(...o)),class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 shadow-sm"},[t(p,{size:14,color:"white",class:"mr-1"},{default:i(()=>[t(e(C))]),_:1}),ve(" 查询 ")])])])])])]),a("div",ot,[e(r)==="user"||e(r)==="checker"||e(r)==="pricer"?(l(),h("div",st,[t(F,{title:e(M),subtitle:`${I()} 工作概览`,icon:e(ye)},{right:i(()=>[a("div",lt,[it,a("div",nt,V(oe()),1)])]),_:1},8,["title","subtitle","icon"]),a("div",rt,[t(d,{title:"签收订单",mainValue:e(s).signed_order_count||0,subValue:`${e(s).signed_device_count||0} 台`,color:"blue",icon:e(we),showIndicator:!0},null,8,["mainValue","subValue","icon"]),e(s).check_count>0||["checker","admin"].includes(e(r))?(l(),f(d,{key:0,title:"质检设备",mainValue:e(s).check_count||0,subValue:"已质检",color:"green",icon:e(C),showIndicator:!0},null,8,["mainValue","icon"])):v("",!0),e(s).price_count>0||["pricer","admin"].includes(e(r))?(l(),f(d,{key:1,title:"定价设备",mainValue:e(s).price_count||0,subValue:`¥${e(s).total_amount||0}`,color:"orange",icon:e(ke),showIndicator:!0},null,8,["mainValue","subValue","icon"])):v("",!0),e(s).payment_count>0||["pricer","admin"].includes(e(r))?(l(),f(d,{key:2,title:"打款设备",mainValue:e(s).payment_count||0,subValue:"已打款",color:"red",icon:e(B),showIndicator:!0},null,8,["mainValue","icon"])):v("",!0)]),t(R,{title:"设备分类分布",icon:e(Ve)},{default:i(()=>[a("div",{ref_key:"userCategoryChart",ref:z,class:"w-full h-80"},null,512)]),_:1},8,["icon"])])):e(r)==="admin"?(l(),h("div",ct,[a("div",dt,[t(F,{title:"运营概览",subtitle:`${I()} 业务数据`,icon:e(Ce),bgClass:"bg-gradient-to-r from-purple-600 to-blue-600"},null,8,["subtitle","icon"]),a("div",ut,[t(d,{title:se(),mainValue:e(u).today_order_count||0,subValue:`昨日 ${e(u).yesterday_order_count||0}`,color:"blue",icon:e(De)},null,8,["title","mainValue","subValue","icon"]),t(d,{title:le(),mainValue:e(u).today_check_count||0,color:"green",icon:e(C),extraInfo:(e(u).today_check_breakdown||[]).slice(0,2).map(o=>`${o.category_name} ${o.count}`)},null,8,["title","mainValue","icon","extraInfo"]),t(d,{title:ie(),mainValue:`¥${e(u).today_payment_amount||0}`,subValue:`${e(u).today_payment_count||0} 台`,color:"orange",icon:e(B)},null,8,["title","mainValue","subValue","icon"]),t(d,{title:ne(),mainValue:e(u).today_return_count||0,subValue:"设备数量",color:"red",icon:e(ze)},null,8,["title","mainValue","icon"])])]),t(R,{title:"员工工作统计",icon:e($e)},{"header-right":i(()=>[a("div",_t,[mt,t(ce,{modelValue:k.value,"onUpdate:modelValue":n[2]||(n[2]=o=>k.value=o),placeholder:"全部员工",clearable:"",onChange:ae,size:"small",class:"w-36"},{default:i(()=>[t(P,{label:"全部员工",value:""}),(l(!0),h(T,null,Y(e(N),o=>(l(),f(P,{key:o.uid,label:o.real_name||o.username,value:o.uid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:i(()=>[t(ue,{gutter:16},{default:i(()=>[t(E,{xs:24,lg:14},{default:i(()=>[a("div",pt,[Ue((l(),f(de,{data:e(D),size:"small",height:400,class:"compact-table"},{default:i(()=>[t(_,{prop:"user_name",label:"员工",width:"90",fixed:""}),t(_,{prop:"user_type_name",label:"角色",width:"70"}),t(_,{prop:"signed_order_count",label:"签收单",width:"80"}),t(_,{prop:"signed_device_count",label:"签收台",width:"80"}),t(_,{prop:"check_count",label:"质检",width:"70"}),t(_,{prop:"price_count",label:"定价",width:"70"}),t(_,{prop:"payment_count",label:"打款",width:"70"})]),_:1},8,["data"])),[[_e,e(O)]])])]),_:1}),t(E,{xs:24,lg:10},{default:i(()=>[a("div",ht,[gt,a("div",{ref_key:"adminUserChart",ref:U,class:"flex-1 min-h-[400px]"},null,512)])]),_:1})]),_:1})]),_:1},8,["icon"])])):v("",!0)])])}}});const Mt=qe(ft,[["__scopeId","data-v-d6df18d2"]]);export{Mt as default};
