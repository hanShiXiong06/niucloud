import{d as J,j as K,r as d,l as Q,q as o,I,cM as X,h as f,s as c,w as t,a as b,e as s,i as h,t as v,u,Z as Y,v as B,bb as S,c as ee,F as le,W as ae,C as oe,L as re,M as te,a0 as se,aF as ue,bD as ie,aj as ne,ak as de,N as me,U as pe,E as _e,V as fe,a3 as ve}from"./index-9cfed1fc.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                        *//* empty css               *//* empty css                          */import ce from"./index-a4ad10ba.js";import"./el-form-item-4ed993c7.js";/* empty css                 */import{d as be,f as ge,h as we}from"./user-9d7f6a26.js";import{_ as Ve}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-fad85f8a.js";import"./attachment-4de82df9.js";import"./index.vue_vue_type_script_setup_true_lang-c04cd2bb.js";/* empty css                  *//* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                        *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-218b436b.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-e50d9a7c.js";import"./sortable.esm-be94e56d.js";const he={class:"max-h-[60vh]"},ye={class:"w-full"},Ce={class:"dialog-footer"},Pe=J({__name:"user-edit",emits:["complete"],setup(xe,{expose:$,emit:D}){const y=K(),p=d(!1),m=d(!0),l=d({uid:0,username:"",password:"",head_img:"",mobile:"",real_name:"",confirm_password:"",create_site_limit:[],group_ids:[]}),g=d({}),M=d(),L=Q(()=>({username:[{required:!0,message:o("usernamePlaceholder"),trigger:"blur"}],password:[{required:y.userInfo&&y.userInfo.is_super_admin==!0,message:o("passwordPlaceholder"),trigger:"blur"}],mobile:[{required:!0,message:o("请输入手机号"),trigger:"blur"},{validator:(i,e,r)=>{I.mobile(e)?r():r(new Error(o("手机号格式错误")))},trigger:"blur"}],real_name:[{required:!0,message:o("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:y.userInfo&&y.userInfo.is_super_admin==!0,message:o("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(i,e,r)=>{e!=l.value.password?r(new Error(o("confirmPasswordError"))):r()},trigger:"blur"}],create_site_limit:[{validator:(i,e,r)=>{l.value.uid&&r();let n=!0;for(let V=0;V<l.value.create_site_limit.length;V++){const _=l.value.create_site_limit[V];if(I.empty(_.num)){r(o("siteNumPlaceholder")),n=!1;break}if(_.num<1){r(o("siteNumCannotLtOne")),n=!1;break}if(I.empty(_.month)){r(o("siteMonthPlaceholder")),n=!1;break}if(_.month<0){r(o("siteMonthCannotLtOne")),n=!1;break}}n&&r()}}]}));X().then(({data:i})=>{const e={};i.forEach(r=>{e[r.group_id]=r}),g.value=e});const q=(i=0)=>{i?be(i).then(({data:e})=>{l.value.uid=e.uid,l.value.username=e.username,l.value.mobile=e.mobile,l.value.real_name=e.real_name,l.value.head_img=e.head_img,m.value=!1,p.value=!0}):(l.value={uid:0,username:"",password:"",head_img:"",mobile:"",real_name:"",confirm_password:"",create_site_limit:[],group_ids:[]},m.value=!1,p.value=!0)},F=i=>{const e=[];i.forEach(r=>{e.push({group_id:r,num:1,month:1})}),l.value.create_site_limit=e},R=async i=>{m.value||!i||await i.validate(async e=>{e&&(m.value=!0,(l.value.uid?ge:we)(l.value).then(()=>{m.value=!1,p.value=!1,D("complete")}).catch(()=>{m.value=!1}))})},w=d(!0),x=d(!0),E=d(!0),C=d("password"),G=()=>{C.value=C.value==="password"?"text":"password"},P=d("password"),T=()=>{P.value=P.value==="password"?"text":"password"};return $({showDialog:p,setFormData:q}),(i,e)=>{const r=re,n=te,V=ce,_=se,j=ue,O=ie,U=ne,z=de,H=me,A=pe,N=_e,W=fe,Z=ve;return f(),c(W,{modelValue:p.value,"onUpdate:modelValue":e[17]||(e[17]=a=>p.value=a),title:l.value.uid?u(o)("updateUser"):u(o)("addUser"),width:"750px","destroy-on-close":!0},{footer:t(()=>[b("span",Ce,[s(N,{onClick:e[15]||(e[15]=a=>p.value=!1)},{default:t(()=>[h(v(u(o)("cancel")),1)]),_:1}),s(N,{type:"primary",loading:m.value,onClick:e[16]||(e[16]=a=>R(M.value))},{default:t(()=>[h(v(u(o)("confirm")),1)]),_:1},8,["loading"])])]),default:t(()=>[s(A,null,{default:t(()=>[b("div",he,[Y((f(),c(H,{model:l.value,"label-width":"120px",ref_key:"formRef",ref:M,rules:u(L),class:"page-form",autocomplete:"off"},{default:t(()=>[s(n,{label:u(o)("username"),prop:"username"},{default:t(()=>[s(r,{modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.username=a),modelModifiers:{trim:!0},clearable:"",placeholder:u(o)("usernamePlaceholder"),class:"input-width",readonly:l.value.uid,disabled:l.value.uid,onClick:e[1]||(e[1]=a=>w.value=!1),onBlur:e[2]||(e[2]=a=>w.value=!0)},null,8,["modelValue","placeholder","readonly","disabled"])]),_:1},8,["label"]),s(n,{label:u(o)("headImg")},{default:t(()=>[s(V,{modelValue:l.value.head_img,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.head_img=a)},null,8,["modelValue"])]),_:1},8,["label"]),s(n,{label:u(o)("手机号"),prop:"mobile"},{default:t(()=>[s(r,{modelValue:l.value.mobile,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.mobile=a),modelModifiers:{trim:!0},placeholder:u(o)("请输入手机号"),clearable:"",class:"input-width",maxlength:"11","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:u(o)("userRealName"),prop:"real_name"},{default:t(()=>[s(r,{modelValue:l.value.real_name,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.real_name=a),modelModifiers:{trim:!0},placeholder:u(o)("userRealNamePlaceholder"),readonly:w.value,onClick:e[6]||(e[6]=a=>w.value=!1),onBlur:e[7]||(e[7]=a=>w.value=!0),clearable:"",class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),s(n,{label:u(o)("password"),prop:"password"},{default:t(()=>[s(r,{modelValue:l.value.password,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.password=a),modelModifiers:{trim:!0},class:B([C.value=="text"?"":"displayPass","input-width"]),clearable:"",placeholder:u(o)("passwordPlaceholder"),readonly:x.value,onClick:e[9]||(e[9]=a=>x.value=!1),onBlur:e[10]||(e[10]=a=>x.value=!0)},{suffix:t(()=>[s(_,{onClick:G,class:"cursor-pointer"},{default:t(()=>[(f(),c(S(C.value==="password"?"Hide":"View")))]),_:1})]),_:1},8,["modelValue","class","placeholder","readonly"])]),_:1},8,["label"]),s(n,{label:u(o)("confirmPassword"),prop:"confirm_password"},{default:t(()=>[s(r,{modelValue:l.value.confirm_password,"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.confirm_password=a),modelModifiers:{trim:!0},class:B([P.value=="text"?"":"displayPass","input-width"]),placeholder:u(o)("confirmPasswordPlaceholder"),clearable:"",readonly:E.value,onClick:e[12]||(e[12]=a=>E.value=!1),onBlur:e[13]||(e[13]=a=>E.value=!0)},{suffix:t(()=>[s(_,{onClick:T,class:"cursor-pointer"},{default:t(()=>[(f(),c(S(P.value==="password"?"Hide":"View")))]),_:1})]),_:1},8,["modelValue","class","placeholder","readonly"])]),_:1},8,["label"]),!l.value.uid&&Object.keys(g.value).length?(f(),c(n,{key:0,label:u(o)("userCreateSiteLimit"),prop:"create_site_limit"},{default:t(()=>[b("div",null,[b("div",null,v(u(o)("siteGroup")),1),s(O,{modelValue:l.value.group_ids,"onUpdate:modelValue":e[14]||(e[14]=a=>l.value.group_ids=a),onChange:F},{default:t(()=>[(f(!0),ee(le,null,ae(g.value,a=>(f(),c(j,{label:a.group_id},{default:t(()=>[h(v(a.group_name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),b("div",ye,[b("div",null,v(u(o)("userCreateSiteLimit")),1),s(z,{data:l.value.create_site_limit,size:"large",class:"w-full"},{default:t(()=>[s(U,{label:u(o)("siteGroup"),"show-overflow-tooltip":!0},{default:t(({row:a})=>[h(v(g.value[a.group_id]?g.value[a.group_id].group_name:""),1)]),_:1},8,["label"]),s(U,{label:u(o)("createSiteNum")},{default:t(({$index:a})=>[s(r,{modelValue:l.value.create_site_limit[a].num,"onUpdate:modelValue":k=>l.value.create_site_limit[a].num=k,modelModifiers:{number:!0,trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),s(U,{label:u(o)("siteMonth")},{default:t(({$index:a})=>[s(r,{modelValue:l.value.create_site_limit[a].month,"onUpdate:modelValue":k=>l.value.create_site_limit[a].month=k,modelModifiers:{number:!0,trim:!0}},{append:t(()=>[h(v(u(o)("month")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data"])])]),_:1},8,["label"])):oe("",!0)]),_:1},8,["model","rules"])),[[Z,m.value]])])]),_:1})]),_:1},8,["modelValue","title"])}}});const il=Ve(Pe,[["__scopeId","data-v-61ed4b8b"]]);export{il as default};
