import{d as T,G as X,j as Y,r as p,l as ee,ca as O,aZ as ae,H as _,er as se,R as te,h as r,s as y,w as u,e as x,a as h,u as m,c as v,B as ne,W as B,F as L,t as F,C as V,y as le,aa as oe,es as ce,K as re,bR as ie,ej as ue,U as de,O as pe,A as he,f as _e,bG as me,a6 as fe,el as ve}from"./index-9cfed1fc.js";/* empty css                     *//* empty css                */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-sub-menu-4ed993c7.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-e50d9a7c.js";/* empty css                 *//* empty css                        */import{_ as xe}from"./icon-addon-one-638e965c.js";import{_ as ge}from"./menu-item.vue_vue_type_style_index_0_lang-b6652fce.js";const ke={class:"one-menu w-[124px] h-screen px-[8px] bg-[#1c2233]"},we={key:0,class:"logo flex items-center m-auto h-[64px]"},Me=h("div",{class:"flex justify-center items-center w-full h-[40px]"},[h("img",{class:"max-w-[40px]",src:xe,alt:"","object-fit":"contain"})],-1),Ae={key:1,class:"logo flex items-center justify-center h-[64px]"},Se=h("i",{class:"text-3xl iconfont iconyunkongjian"},null,-1),Ee=[Se],be={key:0,class:"w-[16px] h-[16px] relative flex justify-center"},Le={key:1,class:"w-[16px] h-[16px]"},Ce={class:"relative flex-1 w-0"},je={class:"ml-[10px] w-full truncate"},Ne=h("div",{class:"h-[48px]"},null,-1),Ke={class:"w-[152px] h-[64px] flex items-center justify-center text-[16px] border-b-[1px] border-solid border-[var(--el-border-color-lighter)]"},Re=h("div",{class:"h-[48px]"},null,-1),Ze=T({__name:"side",setup(Oe){const n=le(),$=_e(),w=X(),g=Y(),t=g.siteInfo,I=g.routers,J=g.addonIndexRoute,k=p([]),o=p([]),M={},U=ee(()=>g.siteInfo.icon?g.siteInfo.icon:w.website.icon);if(I.forEach(e=>{e.original_name=e.name,e.meta.addon==""?e.meta.attr==""&&(e.children&&e.children.length&&(e.name=O(e.children)),k.value.push(e)):e.meta.addon!=""&&(t==null?void 0:t.apps.length)<=1&&(t==null?void 0:t.apps[0].key)==e.meta.addon&&e.meta.show?e.children?(e.children.forEach(a=>{a.original_name=a.name,a.children&&a.children.length&&(a.name=O(a.children))}),k.value.unshift(...e.children)):k.value.unshift(e):M[e.meta.addon]=e}),(t==null?void 0:t.apps.length)>1){const e=[];t==null||t.apps.forEach(a=>{M[a.key]&&(M[a.key].name=J[a.key],e.push(M[a.key]))}),k.value.unshift(...e)}const C=p(null);p(null);const d=p(n.matched[1].name),D=async()=>{const e=await oe();C.value=e.data,_.set({key:"defaultAppList",data:C.value})},j=p([]),G=async()=>{const e=await ce();j.value=e.data.list,_.set({key:"specialAppList",data:j.value})},S=p([]),N=p([]);ae(()=>{D(),G();const e=K();S.value=q(e),N.value=Z(e),_.set({key:"specialMenuNames",data:S.value}),_.set({key:"specialMenuNamesLevel1",data:N.value})});const E=p([]),H=()=>{if(E.value=[],d.value!=="active"&&d.value!=="addon"&&o.value&&Object.values(o.value).length){const e=fe(o.value);for(const a in e)E.value.push(e[a].name)}},W=e=>{if(!e||typeof e!="object")return[];const a=[];return Object.values(e).forEach(s=>{Array.isArray(s.list)&&s.list.forEach(c=>{c.key&&a.push(c.key)})}),a},K=()=>{const e=_.get("specialAppList");if(Array.isArray(e)&&e.length){const a=JSON.parse(JSON.stringify(e)),s=_.get("activeAppKey");a.forEach(l=>{l.children&&Array.isArray(l.children)&&(A=>{A.forEach(f=>{f&&f.is_show!==void 0&&(f.is_show=f.menu_key===s?1:0)})})(l.children)});const c=a.filter(l=>l.children&&l.children.length>0);return se(c)}return[]},q=e=>{const a=[],s=c=>{c.forEach(l=>{l.name&&a.push(l.name),l.children&&Array.isArray(l.children)&&s(l.children)})};return e.forEach(c=>{c.children&&Array.isArray(c.children)&&s(c.children)}),a},Z=e=>{const a=[];return e.forEach(s=>{s.name&&a.push(s.name)}),a},z=e=>{S.value.includes(e)||_.remove("activeAppKey"),$.push({name:e})};return te(n,()=>{if(n.meta.attr!="")d.value=n.matched[1].name,o.value=n.matched[1].children??[];else if((t==null?void 0:t.apps.length)>1)o.value=n.matched[1].children,d.value=n.matched[1].name;else{const s=n.matched[1];s.meta.addon==""?(d.value=n.matched[1].name,o.value=n.matched[1].children??[]):s.meta.addon==(t==null?void 0:t.apps[0].key)?(d.value=n.matched[2].name,o.value=n.matched[2].children??[]):(d.value=n.matched[1].name,o.value=n.matched[1].children??[])}H();const e=_.get("defaultAppList"),a=W(e);if(o.value=o.value.filter(s=>!s.name||!a.includes(s.name)),d.value=="addon"){const s=K();if(s.length){const c=o.value.findIndex(l=>l.name==="addon_list");c!==-1?o.value.splice(c+1,0,...s):o.value.push(...s)}}},{immediate:!0}),(e,a)=>{const s=re,c=ie,l=ye,R=ve,A=ue,f=de,P=pe,Q=he;return r(),y(Q,{class:"w-100 h-screen"},{default:u(()=>[x(P,{class:"flex p-0"},{default:u(()=>[h("div",ke,[x(c,{class:"logo-wrap"},{default:u(()=>[m(w).menuIsCollapse?(r(),v("div",Ae,Ee)):(r(),v("div",we,[x(s,{style:{width:"40px",height:"40px"},src:m(ne)(m(U)),fit:"contain"},{error:u(()=>[Me]),_:1},8,["src"])]))]),_:1}),x(f,{class:"h-[calc( 100vh - 64px )]"},{default:u(()=>[x(A,{"default-active":d.value,router:!0,class:"aside-menu","unique-opened":!0,collapse:m(w).menuIsCollapse},{default:u(()=>[(r(!0),v(L,null,B(k.value,(i,b)=>(r(),v(L,{key:b},[i.meta.show?(r(),y(R,{key:0,index:i.original_name,onClick:Be=>z(i.name)},{title:u(()=>[h("div",Ce,[h("span",je,F(i.meta.short_title||i.meta.title),1)])]),default:u(()=>[i.meta.icon?(r(),v("div",be,[m(me)(i.meta.icon)?(r(),y(s,{key:0,class:"w-[16px] h-[16px] rounded-[50%] overflow-hidden",src:i.meta.icon,fit:"fill"},null,8,["src"])):(r(),y(l,{key:1,name:i.meta.icon,class:"absolute top-[50%] -translate-y-[50%]"},null,8,["name"]))])):(r(),v("div",Le))]),_:2},1032,["index","onClick"])):V("",!0)],64))),128))]),_:1},8,["default-active","collapse"]),Ne]),_:1})]),o.value.length?(r(),y(f,{key:0,class:"two-menu w-[152px]"},{default:u(()=>[h("div",Ke,F(m(n).matched[1].meta.title),1),x(A,{class:"aside-menu","default-active":m(n).name,"default-openeds":E.value,router:!0,collapse:m(w).menuIsCollapse},{default:u(()=>[(r(!0),v(L,null,B(o.value,(i,b)=>(r(),y(ge,{routes:i,key:b},null,8,["routes"]))),128))]),_:1},8,["default-active","default-openeds","collapse"]),Re]),_:1})):V("",!0)]),_:1})]),_:1})}}});export{Ze as _};
