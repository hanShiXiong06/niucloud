import{d as G,r as i,l as x,n as X,q as o,aU as Y,h as p,s as _,w as d,a as Z,e as t,i as v,t as g,u as r,Z as z,c as U,C as E,F as H,W as J,aV as K,aW as Q,aX as ee,ay as le,aY as ae,L as oe,M as re,a4 as te,a1 as se,aD as de,aE as ue,N as ne,E as ie,V as me,a3 as pe}from"./index-0b74b7aa.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import fe from"./index-50c1a6c1.js";import"./el-form-item-4ed993c7.js";import{g as ce}from"./user-7c499c91.js";const _e={key:0},ve={key:0},ge={class:"dialog-footer"},Ie=G({__name:"edit-user",emits:["complete"],setup(we,{expose:B,emit:$}){const F=i([]),f=i(""),P=()=>{ce({}).then(({data:u})=>{F.value=u}).catch()};P();const w=i(!0),b=i(!0),V=i(!0),q=x(()=>!!(l.uid||!f.value||typeof f.value=="string")),c=i(!1),m=i(!1);let y="";const R={uid:0,username:"",head_img:"",real_name:"",password:"",confirm_password:"",status:1,role_ids:[],userrole:{}},l=X({...R}),k=i(),L=x(()=>({uid:[{validator:(u,e,s)=>{!l.uid&&f.value===""?s(new Error(o("managerPlaceholder"))):s()},trigger:"blur"}],username:[{required:l.uid==0,message:o("accountNumberPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:o("userRealNamePlaceholder"),trigger:"blur"}],role_ids:[{required:!0,message:o("userRolePlaceholder"),trigger:"blur"}],password:[{required:l.uid==0,message:o("passwordPlaceholder"),trigger:"blur"}],confirm_password:[{required:l.uid==0,message:o("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(u,e,s)=>{e!=l.password?s(new Error(o("confirmPasswordError"))):s()},trigger:"blur"}]})),h=i([]);Y().then(u=>{h.value=u.data,h.value.forEach(e=>{e.role_id=e.role_id.toString()})});const I=async u=>{if(m.value||!u)return;const e=l.uid?K:Q;await u.validate(async s=>{if(s){m.value=!0;const n=ee(le(l));!l.uid&&typeof f.value=="number"&&(n.uid=f.value),e(n).then(N=>{m.value=!1,c.value=!1,!l.uid&&P(),$("complete")}).catch(()=>{m.value=!1})}})};return B({showDialog:c,setFormData:async(u=null)=>{if(m.value=!0,f.value="",Object.assign(l,R),y=o("addUser"),u){y=o("updateUser");const e=await(await ae(u.uid)).data;e.role_ids=e.role_ids||[],Object.keys(l).forEach(s=>{e[s]!=null&&(l[s]=e[s])})}m.value=!1}}),(u,e)=>{const s=oe,n=re,N=fe,M=te,O=se,C=de,S=ue,j=ne,D=ie,A=me,T=pe;return p(),_(A,{modelValue:c.value,"onUpdate:modelValue":e[15]||(e[15]=a=>c.value=a),title:r(y),width:"500px","destroy-on-close":!0},{footer:d(()=>[Z("span",ge,[t(D,{onClick:e[13]||(e[13]=a=>c.value=!1)},{default:d(()=>[v(g(r(o)("cancel")),1)]),_:1}),t(D,{type:"primary",loading:m.value,onClick:e[14]||(e[14]=a=>I(k.value))},{default:d(()=>[v(g(r(o)("confirm")),1)]),_:1},8,["loading"])])]),default:d(()=>[z((p(),_(j,{model:l,"label-width":"90px",ref_key:"formRef",ref:k,rules:r(L),class:"page-form"},{default:d(()=>[t(n,{label:r(o)("accountNumber"),prop:"username"},{default:d(()=>[t(s,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=a=>l.username=a),modelModifiers:{trim:!0},placeholder:r(o)("accountNumberPlaceholder"),clearable:"",disabled:l.uid,class:"input-width",maxlength:"20","show-word-limit":""},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),r(q)?(p(),U("div",_e,[t(n,{label:r(o)("headImg")},{default:d(()=>[t(N,{modelValue:l.head_img,"onUpdate:modelValue":e[1]||(e[1]=a=>l.head_img=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:r(o)("userRealName"),prop:"real_name"},{default:d(()=>[t(s,{modelValue:l.real_name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.real_name=a),modelModifiers:{trim:!0},placeholder:r(o)("userRealNamePlaceholder"),readonly:w.value,onClick:e[3]||(e[3]=a=>w.value=!1),onBlur:e[4]||(e[4]=a=>w.value=!0),clearable:"",class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),l.uid?E("",!0):(p(),U("div",ve,[t(n,{label:r(o)("password"),prop:"password"},{default:d(()=>[t(s,{modelValue:l.password,"onUpdate:modelValue":e[5]||(e[5]=a=>l.password=a),modelModifiers:{trim:!0},placeholder:r(o)("passwordPlaceholder"),readonly:b.value,onClick:e[6]||(e[6]=a=>b.value=!1),onBlur:e[7]||(e[7]=a=>b.value=!0),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),t(n,{label:r(o)("confirmPassword"),prop:"confirm_password"},{default:d(()=>[t(s,{modelValue:l.confirm_password,"onUpdate:modelValue":e[8]||(e[8]=a=>l.confirm_password=a),modelModifiers:{trim:!0},placeholder:r(o)("confirmPasswordPlaceholder"),readonly:V.value,onClick:e[9]||(e[9]=a=>V.value=!1),onBlur:e[10]||(e[10]=a=>V.value=!0),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"])]))])):E("",!0),l.userrole.is_admin?E("",!0):(p(),_(n,{key:1,label:r(o)("userRoleName"),prop:"role_ids"},{default:d(()=>[t(O,{modelValue:l.role_ids,"onUpdate:modelValue":e[11]||(e[11]=a=>l.role_ids=a),placeholder:r(o)("userRolePlaceholder"),class:"input-width",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:d(()=>[(p(!0),U(H,null,J(h.value,(a,W)=>(p(),_(M,{label:a.role_name,value:a.role_id,key:W,disabled:a.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),t(n,{label:r(o)("status")},{default:d(()=>[t(S,{modelValue:l.status,"onUpdate:modelValue":e[12]||(e[12]=a=>l.status=a)},{default:d(()=>[t(C,{label:1},{default:d(()=>[v(g(r(o)("statusUnlock")),1)]),_:1}),t(C,{label:0},{default:d(()=>[v(g(r(o)("lock")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[T,m.value]])]),_:1},8,["modelValue","title"])}}});export{Ie as _};
