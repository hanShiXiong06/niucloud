import{d as K,y as O,f as G,r as v,q as e,aZ as H,Z as W,h as i,c as h,e as r,w as s,u as t,b3 as J,a as d,t as c,s as k,i as A,C as f,F as q,W as D,d3 as Q,ah as X,$ as Y,b4 as ee,a9 as le,L as te,M as ae,E as oe,a4 as re,a1 as se,N as ne,a3 as de}from"./index-28ce54e5.js";/* empty css                   *//* empty css                *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  */import ue from"./index-16133bab.js";import"./el-form-item-4ed993c7.js";/* empty css                *//* empty css                   *//* empty css                       */import{a as pe,b as ie,c as ce,e as me,f as ve,h as ge}from"./tools-2cf134d7.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-36d764c9.js";/* empty css                  *//* empty css                   */import"./attachment-6a2633f2.js";import"./index.vue_vue_type_script_setup_true_lang-101fc01a.js";/* empty css                      *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                        *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-e5b6971a.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-83b7ba07.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./sortable.esm-be94e56d.js";const he={class:"main-container"},_e={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},ye={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},fe={class:"text-[12px] text-[#a9a9a9] leading-normal"},be={key:1,class:"text-[12px] text-[#a9a9a9] leading-normal"},xe={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},ke={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},Ve={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},we={class:"text-[12px] text-[#a9a9a9] leading-normal"},Pe={key:0,class:"fixed-footer-wrap"},Ee={class:"fixed-footer"},il=K({__name:"edit",setup(Ae){const g=O(),V=G(),F=g.meta.title,N=()=>{V.push("/tools/addon/list")},a=v({title:"",icon:"",key:"",desc:"",author:"",version:"",cover:"",type:"",support_app:"",support_type:1}),C=v([]),m=v(!1),B=v(),w=v([]),T=(n,l,u)=>l!==""?/^[a-zA-Z][a-zA-Z0-9_]*$/.test(l)?u():u(new Error(e("keyPlaceholderErr"))):u(new Error(e("keyPlaceholder"))),$=(n,l,u)=>l!==""?/^([0-9]\d|[0-9])(\.([0-9]){1}){2}$/.test(l)?u():u(new Error(e("versionPlaceholderErr"))):u(new Error(e("versionPlaceholder"))),S=v({title:[{required:!0,message:e("titlePlaceholder"),trigger:"blur"}],icon:[{required:!0,message:e("iconPlaceholder"),trigger:"change"}],key:[{required:!0,validator:T,trigger:"blur"}],author:[{required:!0,message:e("authorPlaceholder"),trigger:"blur"}],version:[{required:!0,validator:$,trigger:"blur"}],cover:[{required:!0,message:e("coverPlaceholder"),trigger:"change"}],type:[{required:!0,message:e("typePlaceholder"),trigger:"change"}],support_app:[{required:!0,message:e("typePlaceholder"),trigger:"change"}]});H(async()=>{const n=await pe();C.value=n.data,g.query.key&&I(g.query.key)});const L=()=>{a.value.support_app=""},I=n=>{m.value=!0,ie(n).then(l=>{a.value=Object.assign(a.value,l.data),m.value=!1}).catch(()=>{m.value=!1})},U=v([]);(async()=>{const{data:n}=await Q();U.value=n})();const R=n=>{me(n).then(l=>{X.alert(l.data?e("warningText"):e("successText"),e("warning"),{confirmButtonText:e("confirm"),callback:u=>{}})})},Z=async n=>{await n.validate(async l=>{if(l){const u=g.query.key?ve:ge;m.value=!0,u(a.value.key,a.value).then(_=>{m.value=!1,Y({message:e("onSaveSuccessText"),type:"success"}),setTimeout(()=>{window.addonActiveName="pluginList",V.push({path:"/tools/addon"})},650)}).catch(()=>{m.value=!1})}})};return ce().then(({data:n})=>{w.value=n}),(n,l)=>{const u=ee,_=le,y=te,p=ae,M=ue,P=oe,b=re,E=se,j=ne,z=de;return W((i(),h("div",he,[r(_,{class:"card !border-none",shadow:"never"},{default:s(()=>[r(u,{content:t(F),icon:t(J),onBack:l[0]||(l[0]=o=>N())},null,8,["content","icon"])]),_:1}),r(_,{class:"box-card mt-[15px] !border-none",shadow:"never"},{default:s(()=>[r(j,{model:a.value,"label-width":"90px",ref_key:"formRef",ref:B,rules:S.value,class:"page-form"},{default:s(()=>[r(p,{label:t(e)("title"),prop:"title"},{default:s(()=>[r(y,{modelValue:a.value.title,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.title=o),modelModifiers:{trim:!0},clearable:"",placeholder:t(e)("titlePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("icon"),prop:"icon"},{default:s(()=>[d("div",null,[r(M,{modelValue:a.value.icon,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.icon=o)},null,8,["modelValue"]),d("p",_e,c(t(e)("iconPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("key"),prop:"key"},{default:s(()=>[d("div",null,[r(y,{modelValue:a.value.key,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.key=o),modelModifiers:{trim:!0},clearable:"",disabled:t(g).query.key,placeholder:t(e)("keyPlaceholder"),class:"input-width mr-[15px]"},null,8,["modelValue","disabled","placeholder"]),t(g).query.key?f("",!0):(i(),k(P,{key:0,type:"primary",disabled:a.value.key=="",onClick:l[4]||(l[4]=o=>R(a.value.key))},{default:s(()=>[A("官方市场标识检测")]),_:1},8,["disabled"])),d("p",ye,c(t(e)("keyPlaceholder1")),1),d("p",fe,c(t(e)("keyPlaceholder2")),1),w.value.length?(i(),h("p",be," 插件标识不能定义成黑名单中的值，插件标识黑名单："+c(w.value.join("，")),1)):f("",!0)])]),_:1},8,["label"]),r(p,{label:t(e)("desc"),prop:"desc"},{default:s(()=>[r(y,{type:"textarea",modelValue:a.value.desc,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.desc=o),modelModifiers:{trim:!0},clearable:"",placeholder:t(e)("descPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("author"),prop:"author"},{default:s(()=>[r(y,{modelValue:a.value.author,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.author=o),modelModifiers:{trim:!0},clearable:"",placeholder:t(e)("authorPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("version"),prop:"version"},{default:s(()=>[d("div",null,[r(y,{modelValue:a.value.version,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.version=o),modelModifiers:{trim:!0},clearable:"",placeholder:t(e)("versionPlaceholder"),class:"input-width",onkeyup:"this.value = this.value.replace(/[^\\d\\.]/g,'');"},null,8,["modelValue","placeholder"]),d("p",xe,c(t(e)("versionPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("cover"),prop:"cover"},{default:s(()=>[d("div",null,[r(M,{modelValue:a.value.cover,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.cover=o)},null,8,["modelValue"]),d("p",ke,c(t(e)("coverPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("type"),prop:"type"},{default:s(()=>[d("div",null,[r(E,{modelValue:a.value.type,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.type=o),placeholder:t(e)("typePlaceholder"),class:"input-width",clearable:"",onChange:L},{default:s(()=>[(i(!0),h(q,null,D(C.value,(o,x)=>(i(),k(b,{key:x,label:o,value:x},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),d("p",Ve,c(t(e)("typePlaceholder1")),1),d("p",we,c(t(e)("typePlaceholder2")),1)])]),_:1},8,["label"]),a.value.type==="addon"?(i(),h(q,{key:0},[r(p,{label:t(e)("supportType")},{default:s(()=>[d("div",null,[r(E,{modelValue:a.value.support_type,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.support_type=o),class:"input-width",onChange:L},{default:s(()=>[r(b,{label:"通用插件",value:1}),r(b,{label:"支持应用",value:2})]),_:1},8,["modelValue"])])]),_:1},8,["label"]),a.value.support_type!=1?(i(),k(p,{key:0,label:t(e)("supportApp"),prop:"support_app"},{default:s(()=>[r(E,{modelValue:a.value.support_app,"onUpdate:modelValue":l[11]||(l[11]=o=>a.value.support_app=o),placeholder:t(e)("supportAppPlaceholder"),class:"input-width"},{default:s(()=>[(i(!0),h(q,null,D(U.value,(o,x)=>(i(),k(b,{label:o.title,value:o.key,key:x},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):f("",!0)],64)):f("",!0)]),_:1},8,["model","rules"])]),_:1}),m.value?f("",!0):(i(),h("div",Pe,[d("div",Ee,[r(P,{type:"primary",onClick:l[12]||(l[12]=o=>Z(B.value))},{default:s(()=>[A(c(t(e)("GeneratePlugins")),1)]),_:1}),r(P,{onClick:l[13]||(l[13]=o=>t(V).push({path:"/tools/addon"}))},{default:s(()=>[A(c(t(e)("cancel")),1)]),_:1})])]))])),[[z,m.value]])}}});export{il as default};
