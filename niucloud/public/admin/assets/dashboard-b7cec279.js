import{d as ze,r as Ye,R as y,ax as x,aZ as Ae,o as Be,h as o,c as u,a,e as t,w as l,u as e,dn as je,t as h,F as M,W as z,v as X,bC as Oe,Y,i as Fe,dZ as A,e5 as Ne,s as V,C as P,dF as qe,dq as ee,e6 as B,e7 as Qe,dr as Ze,e8 as We,e9 as te,ea as Ge,Z as D,dA as He,eb as Je,ec as Ke,ed as Xe,ee as et,a0 as tt,bV as at,b0 as lt,a4 as st,a1 as it,aj as ot,ak as nt,b1 as rt,a3 as ct,p as ut,g as dt}from"./index-9cfed1fc.js";/* empty css                   *//* empty css               *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                  */import{_ as c}from"./StatCard.vue_vue_type_script_setup_true_lang-79a7caf7.js";import{_ as f}from"./ChartCard.vue_vue_type_script_setup_true_lang-ecf5c351.js";import{_ as j}from"./SectionHeader.vue_vue_type_script_setup_true_lang-23806d8b.js";import{u as _t,a as mt,b as pt}from"./useDateFilter-9647fe63.js";import{_ as ht}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-8cd15ab6.js";const R=T=>(ut("data-v-84bc2f03"),T=T(),dt(),T),ft={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50"},gt={class:"bg-white shadow-sm border-b border-gray-100 sticky top-0 z-10"},bt={class:"mx-auto px-4 sm:px-6 lg:px-8 py-4"},vt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},yt={class:"flex items-center space-x-3"},xt={class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center"},Ct=R(()=>a("h1",{class:"text-xl font-semibold text-gray-900"},"数据概览",-1)),wt={class:"text-sm text-gray-500"},kt={class:"flex flex-wrap items-center gap-3"},Vt={class:"flex bg-gray-100 rounded-lg p-1"},Dt=["onClick"],Rt={class:"flex items-center gap-2"},Tt={class:"mx-auto px-4 sm:px-6 lg:px-8 py-6"},St={key:0,class:"space-y-6"},$t={class:"text-right"},It=R(()=>a("div",{class:"text-white/80 text-xs"},"总计设备",-1)),Pt={class:"text-white text-xl font-bold"},Ut={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-2"},Lt={key:1,class:"space-y-6"},Et={class:"space-y-4"},Mt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},zt={class:"flex items-center gap-2"},Yt=R(()=>a("span",{class:"text-xs text-gray-600 whitespace-nowrap"},"员工筛选：",-1)),At={class:"w-full"},Bt={class:"h-full flex flex-col"},jt=R(()=>a("h4",{class:"text-sm font-medium text-gray-700 mb-3"}," 工作量对比 ",-1)),Ot={class:"space-y-4"},Ft={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Nt={class:"w-full h-80 overflow-y-auto"},qt={key:0,class:"flex items-center justify-center h-full text-gray-400"},Qt={key:1,class:"space-y-2 p-2"},Zt={class:"flex items-center gap-3"},Wt={class:"text-sm font-medium text-gray-900"},Gt={class:"text-xs text-gray-500"},Ht={class:"text-right"},Jt={class:"text-lg font-bold text-blue-600"},Kt=R(()=>a("div",{class:"text-xs text-gray-500"},"人",-1)),Xt=ze({__name:"dashboard",setup(T){const{userRole:_,currentUserName:ae,queryParams:g,userWorkStats:n,overviewStats:m,userDetailStats:O,userList:F,userLoading:le,memberStatsOverview:S,memberRegisterTrend:se,memberChannelStats:ie,memberInviteRank:N,memberActivityStats:oe,memberLoading:$,fetchUserDetailStats:ne,fetchData:C}=_t(),{userCategoryChart:q,adminUserChart:Q,overviewRingChart:Z,memberRegisterTrendChart:W,memberChannelChart:G,memberActivityChart:H,initUserCategoryChart:re,updateUserCategoryChart:ce,initAdminUserChart:ue,updateAdminUserChart:de,initOverviewRingChart:_e,updateOverviewRingChart:me,initMemberRegisterTrendChart:pe,updateMemberRegisterTrendChart:he,initMemberChannelChart:fe,updateMemberChannelChart:ge,initMemberActivityChart:be,updateMemberActivityChart:ve,handleResize:J,disposeCharts:ye}=mt(),{dateRange:U,activePeriod:xe,quickPeriods:Ce,handleQuickPeriod:we,handleDateChange:ke,getTimePeriodText:Ve,getPeriodLabel:I}=pt(),L=Ye(""),De=i=>{we(i,(d,b)=>{g.value.start_time=d,g.value.end_time=b,C()})},Re=i=>{ke(i,(d,b)=>{g.value.start_time=d,g.value.end_time=b,C()})},E=()=>Ve(g.value.start_time,g.value.end_time),Te=()=>{ne(L.value)},Se=()=>(n.value.signed_device_count||0)+(n.value.check_count||0)+(n.value.price_count||0)+(n.value.payment_count||0),$e=()=>I("order"),Ie=()=>I("check"),Pe=()=>I("payment"),Ue=()=>I("return");return y(()=>n.value.sign_category_breakdown,i=>{x(()=>{q.value&&(re(),ce(i||[]))})},{deep:!0,immediate:!0}),y(()=>O.value,i=>{x(()=>{Q.value&&(ue(),de(i||[]))})},{deep:!0,immediate:!0}),y(()=>m.value,i=>{x(()=>{Z.value&&(_e(),me(i||{}))})},{deep:!0,immediate:!0}),y(()=>se.value,i=>{x(()=>{W.value&&(pe(),he(i||[]))})},{deep:!0,immediate:!0}),y(()=>ie.value,i=>{x(()=>{G.value&&(fe(),ge(i||[]))})},{deep:!0,immediate:!0}),y(()=>oe.value,i=>{x(()=>{H.value&&(be(),ve(i||[]))})},{deep:!0,immediate:!0}),Ae(()=>{C(),window.addEventListener("resize",J)}),Be(()=>{window.removeEventListener("resize",J),ye()}),(i,d)=>{const b=tt,Le=at,r=lt,K=st,Ee=it,p=ot,Me=nt,v=rt,w=ct;return o(),u("div",ft,[a("div",gt,[a("div",bt,[a("div",vt,[a("div",yt,[a("div",xt,[t(b,{size:18,color:"white"},{default:l(()=>[t(e(je))]),_:1})]),a("div",null,[Ct,a("p",wt,h(e(_)==="admin"?"管理员控制台":"工作台数据"),1)])]),a("div",kt,[a("div",Vt,[(o(!0),u(M,null,z(e(Ce),s=>(o(),u("button",{key:s.key,onClick:k=>De(s.key),class:X(["px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",e(xe)===s.key?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-blue-600 hover:bg-white/50"])},h(s.label),11,Dt))),128))]),a("div",Rt,[t(Le,{modelValue:e(U),"onUpdate:modelValue":d[0]||(d[0]=s=>Oe(U)?U.value=s:null),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:Re,size:"default",class:"custom-date-picker"},null,8,["modelValue"]),a("button",{onClick:d[1]||(d[1]=(...s)=>e(C)&&e(C)(...s)),class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 shadow-sm"},[t(b,{size:14,color:"white",class:"mr-1"},{default:l(()=>[t(e(Y))]),_:1}),Fe(" 查询 ")])])])])])]),a("div",Tt,[e(_)==="user"||e(_)==="checker"||e(_)==="pricer"?(o(),u("div",St,[t(j,{title:e(ae),subtitle:`${E()} 工作概览`,icon:e(A)},{right:l(()=>[a("div",$t,[It,a("div",Pt,h(Se()),1)])]),_:1},8,["title","subtitle","icon"]),a("div",Ut,[t(c,{title:"签收订单",mainValue:e(n).signed_order_count||0,subValue:`${e(n).signed_device_count||0} 台`,color:"blue",icon:e(Ne),showIndicator:!0},null,8,["mainValue","subValue","icon"]),e(n).check_count>0||["checker","admin"].includes(e(_))?(o(),V(c,{key:0,title:"质检设备",mainValue:e(n).check_count||0,subValue:"已质检",color:"green",icon:e(Y),showIndicator:!0},null,8,["mainValue","icon"])):P("",!0),e(n).price_count>0||["pricer","admin"].includes(e(_))?(o(),V(c,{key:1,title:"定价设备",mainValue:e(n).price_count||0,subValue:`¥${e(n).total_amount||0}`,color:"orange",icon:e(qe),showIndicator:!0},null,8,["mainValue","subValue","icon"])):P("",!0),e(n).payment_count>0||["pricer","admin"].includes(e(_))?(o(),V(c,{key:2,title:"打款设备",mainValue:e(n).payment_count||0,subValue:"已打款",color:"red",icon:e(ee),showIndicator:!0},null,8,["mainValue","icon"])):P("",!0)]),t(f,{title:"设备分类分布",icon:e(B)},{default:l(()=>[a("div",{ref_key:"userCategoryChart",ref:q,class:"w-full h-80"},null,512)]),_:1},8,["icon"])])):e(_)==="admin"?(o(),u("div",Lt,[t(v,{gutter:"16"},{default:l(()=>[t(r,{span:12},{default:l(()=>[a("div",Et,[t(j,{title:"运营概览",subtitle:`${E()} 业务数据`,icon:e(Qe),bgClass:"bg-gradient-to-r from-blue-400 to-blue-500"},null,8,["subtitle","icon"]),t(v,{gutter:16},{default:l(()=>[t(r,{span:24},{default:l(()=>[a("div",Mt,[t(c,{title:$e(),mainValue:e(m).today_order_count||0,subValue:`昨日 ${e(m).yesterday_order_count||0}`,color:"blue",link:"/recycle_order/list",icon:e(Ze)},null,8,["title","mainValue","subValue","icon"]),t(c,{title:Ie(),mainValue:e(m).today_check_count||0,color:"green",link:"/recycle_order/list",icon:e(Y),extraInfo:(e(m).today_check_breakdown||[]).slice(0,2).map(s=>`${s.category_name} ${s.count}`)},null,8,["title","mainValue","icon","extraInfo"]),t(c,{title:Pe(),mainValue:`¥${e(m).today_payment_amount||0}`,subValue:`${e(m).today_payment_count||0} 台`,color:"orange",link:"/recycle_order/list",icon:e(ee)},null,8,["title","mainValue","subValue","icon"]),t(c,{title:Ue(),mainValue:e(m).today_return_count||0,subValue:"设备数量",link:"/recycle_return_order/list",color:"red",icon:e(We)},null,8,["title","mainValue","icon"])])]),_:1}),t(r,{span:12},{default:l(()=>[t(f,{title:"业务分布",icon:e(B),contentClass:"py-2 ",class:"mt-4"},{default:l(()=>[a("div",{ref_key:"overviewRingChart",ref:Z,class:"w-full h-80"},null,512)]),_:1},8,["icon"])]),_:1}),t(r,{span:12,class:"mt-4"},{default:l(()=>[t(f,{title:"员工工作统计",icon:e(te)},Ge({default:l(()=>[t(v,{gutter:16},{default:l(()=>[t(r,{xs:24,lg:24},{default:l(()=>[a("div",At,[D((o(),V(Me,{data:e(O),size:"small",class:"w-full min-h-[293px]"},{default:l(()=>[t(p,{prop:"user_name",label:"员工",fixed:""}),t(p,{prop:"user_type_name",label:"角色"}),t(p,{prop:"signed_order_count",label:"签收单"}),t(p,{prop:"signed_device_count",label:"签收台"}),t(p,{prop:"check_count",label:"质检"}),t(p,{prop:"price_count",label:"定价"}),t(p,{prop:"payment_count",label:"打款"})]),_:1},8,["data"])),[[w,e(le)]])])]),_:1})]),_:1})]),_:2},[e(F).length>0?{name:"header-right",fn:l(()=>[a("div",zt,[Yt,t(Ee,{modelValue:L.value,"onUpdate:modelValue":d[2]||(d[2]=s=>L.value=s),placeholder:"全部员工",clearable:"",onChange:Te},{default:l(()=>[t(K,{label:"全部员工",value:""}),(o(!0),u(M,null,z(e(F),s=>(o(),V(K,{key:s.uid,label:s.real_name||s.username,value:String(s.uid)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1032,["icon"])]),_:1}),t(r,{xs:24,lg:24},{default:l(()=>[a("div",Bt,[jt,a("div",{ref_key:"adminUserChart",ref:Q,class:"flex-1 min-h-[400px]"},null,512)])]),_:1})]),_:1})])]),_:1}),t(r,{span:12},{default:l(()=>[a("div",Ot,[t(j,{title:"会员统计",subtitle:`${E()} 用户数据`,icon:e(A),bgClass:"bg-gradient-to-r from-purple-500 to-pink-500"},null,8,["subtitle","icon"]),a("div",Ft,[t(c,{title:"总用户数",mainValue:e(S).total_members||0,subValue:"注册用户",color:"purple",icon:e(A)},null,8,["mainValue","icon"]),t(c,{title:"新增用户",mainValue:e(S).new_members||0,subValue:"期间注册",color:"blue",icon:e(te)},null,8,["mainValue","icon"]),t(c,{title:"活跃用户",mainValue:e(S).active_members||0,subValue:"期间活跃",color:"green",icon:e(He)},null,8,["mainValue","icon"]),t(c,{title:"拉新用户",mainValue:e(S).invite_members||0,subValue:"被推广注册",color:"orange",icon:e(Je)},null,8,["mainValue","icon"])]),t(v,{gutter:16},{default:l(()=>[t(r,{xs:24,lg:16},{default:l(()=>[t(v,{gutter:16},{default:l(()=>[t(r,{span:24},{default:l(()=>[t(f,{title:"注册趋势",icon:e(Ke),contentClass:"py-2"},{default:l(()=>[D(a("div",{ref_key:"memberRegisterTrendChart",ref:W,class:"w-full h-80"},null,512),[[w,e($)]])]),_:1},8,["icon"])]),_:1}),t(r,{span:24,class:"mt-4"},{default:l(()=>[t(f,{title:"用户活跃度",icon:e(Xe),contentClass:"py-2"},{default:l(()=>[D(a("div",{ref_key:"memberActivityChart",ref:H,class:"w-full h-80"},null,512),[[w,e($)]])]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1}),t(r,{xs:24,lg:8},{default:l(()=>[t(v,{gutter:16},{default:l(()=>[t(r,{span:24},{default:l(()=>[t(f,{title:"注册渠道",icon:e(B),contentClass:"py-2"},{default:l(()=>[D(a("div",{ref_key:"memberChannelChart",ref:G,class:"w-full h-80"},null,512),[[w,e($)]])]),_:1},8,["icon"])]),_:1}),t(r,{span:24,class:"mt-4"},{default:l(()=>[t(f,{title:"拉新排行榜 TOP10",icon:e(et),contentClass:"py-2"},{default:l(()=>[D((o(),u("div",Nt,[e(N).length===0?(o(),u("div",qt," 暂无数据 ")):(o(),u("div",Qt,[(o(!0),u(M,null,z(e(N),(s,k)=>(o(),u("div",{key:s.member_id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[a("div",Zt,[a("div",{class:X(["w-7 h-7 flex items-center justify-center rounded-full text-sm font-bold",k===0?"bg-yellow-400 text-white":k===1?"bg-gray-300 text-white":k===2?"bg-orange-400 text-white":"bg-blue-100 text-blue-600"])},h(k+1),3),a("div",null,[a("div",Wt,h(s.nickname),1),a("div",Gt,h(s.mobile),1)])]),a("div",Ht,[a("div",Jt,h(s.invite_count),1),Kt])]))),128))]))])),[[w,e($)]])]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})])):P("",!0)])])}}});const xa=ht(Xt,[["__scopeId","data-v-84bc2f03"]]);export{xa as default};
