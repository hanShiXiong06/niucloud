import{d as P,G as Q,j as T,r as p,l as X,ca as B,aZ as Y,H as h,eq as ee,R as ae,h as r,s as A,w as i,e as f,a as d,u as v,c as y,B as se,W as O,F as b,t as V,C as L,y as te,aa as ne,er as le,K as oe,bR as ce,ei as re,U as ie,O as ue,A as de,f as pe,ek as he}from"./index-28ce54e5.js";/* empty css                     *//* empty css                */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-sub-menu-4ed993c7.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-83b7ba07.js";/* empty css                 *//* empty css                        */import{_ as me}from"./icon-addon-one-638e965c.js";import{_ as fe}from"./menu-item.vue_vue_type_style_index_0_lang-ce795075.js";const ve={class:"w-[64px] bg-[#282c34] h-screen one-menu"},ye={key:0,class:"logo flex items-center m-auto h-[64px]"},xe=d("div",{class:"flex justify-center items-center w-full h-[40px]"},[d("img",{class:"max-w-[40px]",src:me,alt:"","object-fit":"contain"})],-1),ge={key:1,class:"logo flex items-center justify-center h-[64px]"},ke=d("i",{class:"text-3xl iconfont iconyunkongjian"},null,-1),we=[ke],Ae={key:0,class:"w-[16px] h-[16px] relative flex justify-center"},Me={class:"relative"},Se={class:"ml-[10px] text-[15px]"},Ee=d("div",{class:"h-[48px]"},null,-1),be={class:"w-[190px] h-[64px] flex items-center justify-center text-[16px] border-0 border-b-[1px] border-solid border-[#eee]"},Le=d("div",{class:"h-[48px]"},null,-1),Ie=P({__name:"side",setup(Ce){const M=Q(),x=T(),n=te(),$=pe(),t=x.siteInfo,F=x.routers,J=x.addonIndexRoute,g=p([]),c=p([]),k={},q=X(()=>x.siteInfo.icon?x.siteInfo.icon:M.website.icon);if(F.forEach(e=>{e.original_name=e.name,e.meta.addon==""?e.meta.attr==""&&(e.children&&e.children.length&&(e.name=B(e.children)),g.value.push(e)):e.meta.addon!=""&&(t==null?void 0:t.apps.length)<=1&&(t==null?void 0:t.apps[0].key)==e.meta.addon&&e.meta.show?e.children?(e.children.forEach(a=>{a.original_name=a.name,a.children&&a.children.length&&(a.name=B(a.children))}),g.value.unshift(...e.children)):g.value.unshift(e):k[e.meta.addon]=e}),(t==null?void 0:t.apps.length)>1){const e=[];t==null||t.apps.forEach(a=>{k[a.key]&&(k[a.key].name=J[a.key],e.push(k[a.key]))}),g.value.unshift(...e)}const _=p(n.matched[1].name),C=p(null);p(null);const H=async()=>{const e=await ne();C.value=e.data,h.set({key:"defaultAppList",data:C.value})},N=p([]),I=async()=>{const e=await le();N.value=e.data.list,h.set({key:"specialAppList",data:N.value})},S=p([]),j=p([]);Y(()=>{H(),I();const e=K();j.value=G(e),S.value=D(e),h.set({key:"specialMenuNames",data:S.value}),h.set({key:"specialMenuNamesLevel1",data:j.value})});const U=e=>{if(!e||typeof e!="object")return[];const a=[];return Object.values(e).forEach(s=>{Array.isArray(s.list)&&s.list.forEach(o=>{o.key&&a.push(o.key)})}),a},K=()=>{const e=h.get("specialAppList");if(Array.isArray(e)&&e.length){const a=JSON.parse(JSON.stringify(e)),s=h.get("activeAppKey");a.forEach(l=>{l.children&&Array.isArray(l.children)&&(w=>{w.forEach(m=>{m&&m.is_show!==void 0&&(m.is_show=m.menu_key===s?1:0)})})(l.children)});const o=a.filter(l=>l.children&&l.children.length>0);return ee(o)}return[]},D=e=>{const a=[],s=o=>{o.forEach(l=>{l.name&&a.push(l.name),l.children&&Array.isArray(l.children)&&s(l.children)})};return e.forEach(o=>{o.children&&Array.isArray(o.children)&&s(o.children)}),a},G=e=>{const a=[];return e.forEach(s=>{s.name&&a.push(s.name)}),a},W=e=>{S.value.includes(e)||h.remove("activeAppKey"),$.push({name:e})};return ae(n,()=>{if(n.meta.attr!="")_.value=n.matched[1].name,c.value=n.matched[1].children??[];else if((t==null?void 0:t.apps.length)>1)c.value=n.matched[1].children,_.value=n.matched[1].name;else{const s=n.matched[1];s.meta.addon==""?(_.value=n.matched[1].name,c.value=n.matched[1].children??[]):s.meta.addon==(t==null?void 0:t.apps[0].key)?(_.value=n.matched[2].name,c.value=n.matched[2].children??[]):(_.value=n.matched[1].name,c.value=n.matched[1].children??[])}const e=h.get("defaultAppList"),a=U(e);if(c.value=c.value.filter(s=>!s.name||!a.includes(s.name)),_.value=="addon"){const s=K();if(s.length){const o=c.value.findIndex(l=>l.name==="addon_list");o!==-1?c.value.splice(o+1,0,...s):c.value.push(...s)}}},{immediate:!0}),(e,a)=>{const s=oe,o=ce,l=_e,R=he,w=re,m=ie,Z=ue,z=de;return r(),A(z,{class:"w-100 h-screen"},{default:i(()=>[f(Z,{class:"p-0 flex"},{default:i(()=>[d("div",ve,[f(o,{class:"logo-wrap"},{default:i(()=>[v(M).menuIsCollapse?(r(),y("div",ge,we)):(r(),y("div",ye,[f(s,{style:{width:"40px",height:"40px"},src:v(se)(v(q)),fit:"contain"},{error:i(()=>[xe]),_:1},8,["src"])]))]),_:1}),f(m,{class:"h-[calc( 100vh - 64px )]"},{default:i(()=>[f(w,{"default-active":_.value,router:!0,class:"aside-menu","unique-opened":!0},{default:i(()=>[(r(!0),y(b,null,O(g.value,(u,E)=>(r(),y(b,{key:E},[u.meta.show?(r(),A(R,{key:0,index:u.original_name,onClick:Ne=>W(u.name)},{title:i(()=>[d("div",Me,[d("span",Se,V(u.meta.short_title||u.meta.title),1)])]),default:i(()=>[u.meta.icon?(r(),y("div",Ae,[f(l,{name:u.meta.icon,class:"absolute top-[50%] -translate-y-[50%]"},null,8,["name"])])):L("",!0)]),_:2},1032,["index","onClick"])):L("",!0)],64))),128))]),_:1},8,["default-active"]),Ee]),_:1})]),c.value.length?(r(),A(m,{key:0,class:"two-menu w-[190px]"},{default:i(()=>[d("div",be,V(v(n).matched[1].meta.title),1),f(w,{"default-active":v(n).name,router:!0,class:"aside-menu",collapse:v(M).menuIsCollapse},{default:i(()=>[(r(!0),y(b,null,O(c.value,(u,E)=>(r(),A(fe,{routes:u,key:E},null,8,["routes"]))),128))]),_:1},8,["default-active","collapse"]),Le]),_:1})):L("",!0)]),_:1})]),_:1})}}});export{Ie as _};
