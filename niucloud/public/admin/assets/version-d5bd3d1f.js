import{d as G,y as J,f as K,r as v,n as O,h as m,c as E,e as a,w as s,a as c,t as p,u as o,q as e,i as u,Z as Q,s as g,C as h,ah as T,B as W,aH as X,aI as Y,b6 as ee,E as te,aj as ae,ak as oe,a2 as le,a9 as ne,U as ie,V as se,a3 as re,p as pe,g as ce}from"./index-0b74b7aa.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                  *//* empty css                 *//* empty css                    */import{a as de,d as me,r as ue,b as _e}from"./app-62f733e2.js";import{_ as fe}from"./app-version-edit.vue_vue_type_style_index_0_lang-2bb500c6.js";import{_ as ve}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                */import"./index.vue_vue_type_style_index_0_lang-46ea7c21.js";/* empty css                  *//* empty css                    *//* empty css                  *//* empty css                       *//* empty css                 */import"./el-form-item-4ed993c7.js";import"./generate-sing-cert.vue_vue_type_script_setup_true_lang-0ba527f2.js";const ge=b=>(pe("data-v-0ecd823c"),b=b(),ce(),b),he={class:"main-container"},be={class:"flex justify-between items-center"},we={class:"text-lg"},ke=ge(()=>c("div",{class:"flex items-center"},[c("div",null,[c("p",null,"使用云打包提交成功后请先不要离开该页面稍待几分钟等待打包结果的返回")])],-1)),ye={class:"mt-[20px]"},xe={class:"mt-[10px]"},Ce={key:0},Ve={class:"mt-[16px] flex justify-end"},Ee=["innerHTML"],Te=G({__name:"version",setup(b){const B=J(),D=K(),R=B.meta.title,k=v("/channel/app/version"),l=O({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{platfrom:""}}),L=n=>{D.push({path:k.value})};v();const d=(n=1)=>{l.loading=!0,l.page=n,de({page:l.page,limit:l.limit,...l.searchParam}).then(i=>{l.loading=!1,l.data=i.data.data,l.total=i.data.total,n==1&&l.data.length&&l.data[0].status=="creating"&&x(l.data[0].task_key)}).catch(()=>{l.loading=!1})};d();const f=v(null),N=()=>{f.value.setFormData(),f.value.showDialog=!0},$=n=>{f.value.setFormData(n),f.value.showDialog=!0},z=n=>{T.confirm(e("appVersionDeleteTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{me({id:n}).then(()=>{d()}).catch(()=>{})})},A=n=>{T.confirm(e("appVersionReleaseTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{ue(n.id).then(()=>{d()}).catch(()=>{})})},x=n=>{_e(n).then(i=>{i.data&&(i.data.status==""?setTimeout(()=>{x(n)},2e3):d())})},C=v(""),y=v(!1),F=n=>{C.value=n.fail_reason,y.value=!0},S=n=>{window.open(W(n.package_path),"_blank")};return(n,i)=>{const V=X,U=Y,I=ee,_=te,r=ae,P=oe,j=le,M=ne,H=ie,q=se,Z=re;return m(),E("div",he,[a(M,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[c("div",be,[c("span",we,p(o(R)),1)]),a(U,{modelValue:k.value,"onUpdate:modelValue":i[0]||(i[0]=t=>k.value=t),class:"my-[20px]",onTabChange:L},{default:s(()=>[a(V,{label:o(e)("accessFlow"),name:"/channel/app"},null,8,["label"]),a(V,{label:o(e)("versionManage"),name:"/channel/app/version"},null,8,["label"])]),_:1},8,["modelValue"]),a(I,{type:"info"},{default:s(()=>[ke]),_:1}),c("div",ye,[a(_,{type:"primary",onClick:N},{default:s(()=>[u(p(o(e)("addAppVersion")),1)]),_:1})]),c("div",xe,[Q((m(),g(P,{data:l.data,size:"large"},{empty:s(()=>[c("span",null,p(l.loading?"":o(e)("emptyData")),1)]),default:s(()=>[a(r,{type:"index",width:"90",label:o(e)("index")},null,8,["label"]),a(r,{prop:"version_code",label:o(e)("versionCode"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{prop:"version_name",label:o(e)("versionName"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{prop:"version_desc",label:o(e)("versionDesc"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{prop:"platform_name",label:o(e)("platform"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{prop:"status_name",label:o(e)("status"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{prop:"status",label:o(e)("isForcedUpgradeTitle"),"min-width":"120",align:"center","show-overflow-tooltip":!0},{default:s(({row:t})=>[u(p(t.is_forced_upgrade?"是":"否"),1)]),_:1},8,["label"]),a(r,{prop:"package_path",label:o(e)("packagePath"),"min-width":"120","show-overflow-tooltip":!0},null,8,["label"]),a(r,{label:o(e)("releaseTime"),"min-width":"120","show-overflow-tooltip":!0},{default:s(({row:t})=>[t.release_time!=0?(m(),E("text",Ce,p(t.release_time),1)):h("",!0)]),_:1},8,["label"]),a(r,{label:o(e)("operation"),fixed:"right",align:"right","min-width":"200px"},{default:s(({row:t})=>[t.release_time==0?(m(),g(_,{key:0,type:"primary",link:"",onClick:w=>$(t)},{default:s(()=>[u(p(o(e)("edit")),1)]),_:2},1032,["onClick"])):h("",!0),t.status=="upload_success"?(m(),g(_,{key:1,type:"primary",link:"",onClick:w=>A(t)},{default:s(()=>[u(p(o(e)("release")),1)]),_:2},1032,["onClick"])):h("",!0),t.status=="create_fail"?(m(),g(_,{key:2,type:"primary",link:"",onClick:w=>F(t)},{default:s(()=>[u(p(o(e)("failReason")),1)]),_:2},1032,["onClick"])):h("",!0),t.package_path&&t.upgrade_type!="market"?(m(),g(_,{key:3,type:"primary",link:"",onClick:w=>S(t)},{default:s(()=>[u(p(o(e)("download")),1)]),_:2},1032,["onClick"])):h("",!0),a(_,{type:"primary",link:"",onClick:w=>z(t.id)},{default:s(()=>[u(p(o(e)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Z,l.loading]]),c("div",Ve,[a(j,{"current-page":l.page,"onUpdate:current-page":i[1]||(i[1]=t=>l.page=t),"page-size":l.limit,"onUpdate:page-size":i[2]||(i[2]=t=>l.limit=t),layout:"total, sizes, prev, pager, next, jumper",total:l.total,onSizeChange:i[3]||(i[3]=t=>d()),onCurrentChange:d},null,8,["current-page","page-size","total"])])]),a(fe,{ref_key:"editAppVersionDialog",ref:f,onComplete:d},null,512)]),_:1}),a(q,{modelValue:y.value,"onUpdate:modelValue":i[4]||(i[4]=t=>y.value=t),title:o(e)("failReason"),width:"60%"},{default:s(()=>[a(H,{class:"h-[60vh] w-full whitespace-pre-wrap p-[20px]"},{default:s(()=>[c("div",{innerHTML:C.value},null,8,Ee)]),_:1})]),_:1},8,["modelValue","title"])])}}});const nt=ve(Te,[["__scopeId","data-v-0ecd823c"]]);export{nt as default};
