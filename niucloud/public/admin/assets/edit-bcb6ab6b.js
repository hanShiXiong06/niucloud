import{d as ye,bQ as we,y as Ce,f as ke,r as g,n as ee,R as Ve,a6 as ze,h as p,c as m,e as l,w as i,a,u as t,b3 as Te,t as f,q as s,F as y,W as z,s as w,i as B,C as k,x as te,v as N,X as S,bb as oe,B as Ee,ah as ne,ay as le,a0 as qe,a4 as Ie,a1 as Pe,E as Ne,bR as Se,ac as Me,ad as $e,U as De,b9 as Be,M as Ue,bK as je,bI as Re,b7 as Fe,aD as Ae,aE as Le,N as Oe,a9 as He,V as We,p as Ge,g as Xe}from"./index-28ce54e5.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                     *//* empty css                         */import{_ as Ze}from"./index.vue_vue_type_script_setup_true_lang-83b7ba07.js";/* empty css               *//* empty css                  *//* empty css                  */import{_ as Je}from"./edit-draw-697db674.js";import{_ as Qe}from"./edit-friendspay-message-32def71c.js";import{_ as Ye}from"./edit-friendspay-money-2fdc6c1c.js";import{_ as Ke}from"./edit-headimg-d577cc4a.js";import{_ as et}from"./edit-image-85c51f2f.js";import{_ as tt}from"./edit-nickname-a644ce3f.js";import{_ as ot}from"./edit-page-18a31a8b.js";import{_ as nt}from"./edit-qrcode-209898e4.js";import{_ as lt}from"./edit-text-b69751fc.js";import{_ as at}from"./preview-draw-4e08c6e2.js";import{_ as st}from"./preview-friendspay-message-e0925225.js";import{_ as it}from"./preview-friendspay-money-9e52fe9b.js";import{_ as rt}from"./preview-headimg-8fa9a4c5.js";import{_ as ct}from"./preview-image-a485bed5.js";import{_ as pt}from"./preview-nickname-404a482f.js";import{_ as dt}from"./preview-qrcode-2b567b1f.js";import{_ as ut}from"./preview-text-9ec21a51.js";import{u as mt}from"./poster-a69daa80.js";import{i as _t,g as ft,e as vt,a as gt,b as xt}from"./poster-f196d244.js";import{_ as ht}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-16133bab.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-36d764c9.js";import"./attachment-6a2633f2.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-101fc01a.js";/* empty css                      *//* empty css                    *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                        *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-e5b6971a.js";/* empty css                   */import"./sortable.esm-be94e56d.js";const ae=M=>(Ge("data-v-3985b328"),M=M(),Xe(),M),bt={class:"main-container flex-1"},yt={class:"pl-[5px] text-[14px]"},wt={class:"text-white ml-[10px] mr-[20px] flex items-center"},Ct=ae(()=>a("span",{class:"mr-[5px] text-[rgba(255,255,255,.5)]"},"｜",-1)),kt={class:"mr-[5px] text-[14px]"},Vt={class:"flex items-center"},zt={class:"text-white mr-[10px] text-base"},Tt={class:"w-[180px]"},Et=ae(()=>a("div",{class:"flex-1"},null,-1)),qt={class:"full-container flex flex-row flex-1 bg-page"},It={class:"component-list w-[290px]"},Pt={class:"flex flex-row flex-wrap"},Nt=["title","onClick"],St={class:"block text-[12px] truncate"},Mt={class:"preview-wrap flex-1 relative mt-[20px]"},$t={class:"diy-view-wrap w-[360px] shadow-lg mx-auto"},Dt={class:"content-wrap"},Bt={class:"title-wrap text-center text-[14px]"},Ut={class:"preview-block relative max-h-[640px]"},jt={class:"quick-action absolute text-center -right-[70px] top-[20px] w-[42px] rounded shadow-md"},Rt=["id","onMousedown","onClick"],Ft=["onMousedown"],At=["onMousedown"],Lt=["onMousedown"],Ot=["onMousedown"],Ht={class:"edit-attribute-wrap w-[400px]"},Wt={class:"card-header flex justify-between items-center"},Gt={class:"title flex-1"},Xt={class:"edit-component-wrap"},Zt={class:"edit-attr-item-wrap"},Jt={class:"mb-[10px]"},Qt={class:"flex items-center"},Yt=["onClick"],Kt=["title"],eo={class:"text-sm mt-[10px] leading-[1.4] text-gray-400"},to={class:"flex items-center"},oo=["onClick"],no=["title"],lo={key:0},ao=["src"],so=ye({__name:"edit",setup(M){we("setLayout")("decorate");const e=mt(),_=Ce(),se=ke();_&&_.query&&(_.query.id=_.query.id||0,_.query.type=_.query.type||"",_.query.name=_.query.name||"",_.query.back=_.query.back||"/site/poster/list");const $=_.query.back,T=g(""),O=g(""),E=g([]),H=ee([]);g("");const W=g(H),ie=r=>{},re=r=>{let o={transform:"",zIndex:"",top:"",left:"",right:"",bottom:""};switch(o.transform=`rotate(${r.angle}deg)`,o.zIndex=`${r.zIndex}`,r.y){case"top":o.top=0;break;case"center":o.top="50%",o.transform=o.transform+" translateY(-50%)";break;case"bottom":o.bottom=0;break;default:o.top=r.y+"px"}switch(r.x){case"left":o.left=0;break;case"center":o.left="50%",o.transform=o.transform+" translateX(-50%)";break;case"right":o.right=0;break;default:o.left=r.x+"px"}return o},G=g([{name:"左",src:"iconzuoduiqi1",className:"left"},{name:"中",src:"iconshuipingjuzhong1",className:"center"},{name:"右",src:"iconyouduiqi1",className:"right"}]),X=g([{name:"上",src:"icondingduiqi1",className:"top"},{name:"中",src:"iconchuizhijuzhong1",className:"center"},{name:"下",src:"icondiduiqi1",className:"bottom"}]),Z=(r,o)=>{e.editComponent[r]=o.className},ce=g(!0),pe=()=>{ce.value?(location.href=`${location.origin}${$}`,se.push($)):ne.confirm(s("leavePageTitleTips"),s("leavePageContentTips"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning",autofocus:!1}).then(()=>{location.href=`${location.origin}${$}`}).catch(()=>{})},J=Object.assign({"./components/edit-draw.vue":Je,"./components/edit-friendspay-message.vue":Qe,"./components/edit-friendspay-money.vue":Ye,"./components/edit-headimg.vue":Ke,"./components/edit-image.vue":et,"./components/edit-nickname.vue":tt,"./components/edit-page.vue":ot,"./components/edit-qrcode.vue":nt,"./components/edit-text.vue":lt,"./components/preview-draw.vue":at,"./components/preview-friendspay-message.vue":st,"./components/preview-friendspay-money.vue":it,"./components/preview-headimg.vue":rt,"./components/preview-image.vue":ct,"./components/preview-nickname.vue":pt,"./components/preview-qrcode.vue":dt,"./components/preview-text.vue":ut}),Q=Object.assign({});Q&&Object.assign(J,Q);const U={};for(const[r,o]of Object.entries(J)){const c=r.split("/").pop().split(".")[0];U[c]=o.default}const V=ee([]),de=()=>{ft({addon:e.addon,type:e.type}).then(r=>{r.data&&(V.splice(0,V.length,...r.data),e.id&&(T.value=V.findIndex(o=>o.type==e.type)))})};Ve(()=>T.value,(r,o)=>{O.value=o});const ue=r=>{if(e.value.length)ne.confirm(s("changeTemplatePosterTips"),s("warning"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning"}).then(()=>{if(e.changeCurrentIndex(-99),r!==""){let o=V[r].data;e.global=o.global,o.value.length&&(e.value=o.value)}else e.init()}).catch(()=>{T.value=O.value});else if(r!==""){let o=V[r].data;e.global=o.global,o.value.length&&(e.value=o.value)}else e.init()};_t({id:_.query.id,type:_.query.type,name:_.query.name}).then(async r=>{const o=r.data;if(e.init(),e.id=o.id,e.name=o.name,e.channel=o.channel,e.status=o.status,e.isDefault=o.is_default,e.addon=o.addon,e.type=o.type,e.typeName=o.poster_type.name,o.value){const v=o.value;e.global=v.global,v.value.length&&(e.value=v.value)}E.value=o.component;for(const v in E.value){H.push(v);for(const c in E.value[v].list){const x=ze(E.value[v].list[c]);x.id=e.generateRandom(),x.componentName=c,x.componentTitle=x.title,delete x.title,delete x.icon,e.components.push(x)}}de()});const C=g(!1),me=r=>{if(!e.verify()||C.value)return;C.value=!0,e.value.forEach((c,x,D)=>{const q=document.getElementById(c.id);if(q&&(c.width=q.offsetWidth,c.height=q.offsetHeight,c.type=="draw")){let b=[c.x*1,c.y*1],F=[(c.x+c.width)*1,c.y*1],A=[(c.x+c.width)*1,(c.y+c.height)*1],I=[c.x*1,(c.y+c.height)*1];c.points=[b,F,A,I]}delete c.verify});let o={id:e.id,name:e.name,type:e.type,status:e.status,is_default:e.isDefault,channel:e.channel,addon:e.addon,value:JSON.stringify({global:le(e.global),value:le(e.value)})};(e.id?vt:gt)(o).then(c=>{c.code==1&&(e.id?C.value=!1:location.href=`${location.origin}${$}`,r&&r(c.data.id))}).catch(()=>{C.value=!1}).finally(()=>{})},j=g(!1),R=g(""),_e=()=>{C.value||(C.value=!0,xt({id:e.id,type:e.type}).then(r=>{r.data&&(R.value=r.data,j.value=!0),C.value=!1}))};return(r,o)=>{const v=qe,c=Ie,x=Pe,D=Ne,q=Se,b=Ze,F=Me,A=$e,I=De,P=Be,h=Ue,L=je,Y=Re,fe=Fe,ve=Ae,ge=Le,xe=Oe,he=He,be=We;return p(),m("div",bt,[l(q,{class:"flex items-center h-[60px] bg-primary px-[20px]"},{default:i(()=>[a("div",{class:"text-white cursor-pointer flex items-center",onClick:pe},[l(v,{size:"14"},{default:i(()=>[l(t(Te))]),_:1}),a("span",yt,f(t(s)("back")),1)]),a("div",wt,[Ct,a("span",kt,f(t(s)("decorating"))+"："+f(t(e).typeName),1)]),a("div",Vt,[a("span",zt,f(t(s)("templatePosterPlaceholder")),1),a("div",Tt,[l(x,{size:"small",modelValue:T.value,"onUpdate:modelValue":o[0]||(o[0]=n=>T.value=n),placeholder:t(s)("templatePosterPlaceholder"),onChange:ue},{default:i(()=>[l(c,{label:t(s)("templatePosterEmpty"),value:""},null,8,["label"]),(p(!0),m(y,null,z(V,(n,u)=>(p(),w(c,{label:n.name,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),Et,t(e).id?(p(),w(D,{key:0,onClick:o[1]||(o[1]=n=>_e())},{default:i(()=>[B(f(t(s)("preview")),1)]),_:1})):k("",!0),l(D,{onClick:o[2]||(o[2]=n=>me())},{default:i(()=>[B(f(t(s)("save")),1)]),_:1})]),_:1}),a("div",qt,[a("div",It,[l(I,{class:"px-[10px]"},{default:i(()=>[l(A,{modelValue:W.value,"onUpdate:modelValue":o[3]||(o[3]=n=>W.value=n),onChange:ie},{default:i(()=>[(p(!0),m(y,null,z(E.value,(n,u)=>(p(),w(F,{key:u,title:n.title,name:u},{default:i(()=>[a("ul",Pt,[(p(!0),m(y,null,z(n.list,(d,K)=>(p(),m("li",{key:K,class:"w-2/6 text-center cursor-pointer h-[65px]",title:d.title,onClick:ro=>t(e).addComponent(K,d)},[d.icon?(p(),w(b,{key:0,name:d.icon,size:"20px",class:"inline-block mt-[3px]"},null,8,["name"])):(p(),w(b,{key:1,name:"iconfont iconkaifazujian",size:"20px",class:"inline-block mt-[3px]"})),a("span",St,f(d.title),1)],8,Nt))),128))])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a("div",Mt,[l(I,null,{default:i(()=>[l(D,{class:"page-btn absolute right-[20px]",onClick:o[4]||(o[4]=n=>t(e).changeCurrentIndex(-99))},{default:i(()=>[B(f(t(s)("posterSet")),1)]),_:1}),a("div",$t,[a("div",{class:"preview-head bg-no-repeat bg-center bg-cover cursor-pointer h-[64px]",onClick:o[5]||(o[5]=n=>t(e).changeCurrentIndex(-99))},[a("div",Dt,[a("div",Bt,f(t(e).name),1)])]),a("div",Ut,[a("ul",jt,[l(P,{effect:"light",content:t(s)("moveUpComponentZIndex"),placement:"right"},{default:i(()=>[l(b,{name:"iconfont iconjiantoushang",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).moveUpComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("moveDownComponentZIndex"),placement:"right"},{default:i(()=>[l(b,{name:"iconfont iconjiantouxia",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).moveDownComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("copyComponent"),placement:"right"},{default:i(()=>[l(b,{name:"iconfont iconcopy-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).copyComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("delComponent"),placement:"right"},{default:i(()=>[l(b,{name:"iconfont icondelete-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).delComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("resetComponent"),placement:"right"},{default:i(()=>[l(b,{name:"iconfont iconloader-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).resetComponent},null,8,["onClick"])]),_:1},8,["content"])]),a("div",{class:"preview-iframe",style:te(t(e).getGlobalStyle()),onClick:o[6]||(o[6]=n=>t(e).changeCurrentIndex(-99))},[(p(!0),m(y,null,z(t(e).value,(n,u)=>(p(),m("div",{class:N(["item-wrap area-box select-none max-w-[720px] cursor-move",{selected:t(e).currentIndex==u}]),id:n.id,key:n.id,style:te(re(n)),onMousedown:d=>t(e).mouseDown(d,n.id,u),onClick:S(d=>t(e).changeCurrentIndex(u,n),["stop"])},[(p(),w(oe(U["preview-"+n.path]),{value:n},null,8,["value"])),a("span",{class:"box1",onMousedown:S(d=>t(e).resizeMouseDown(d,n,u),["stop"])},null,40,Ft),a("span",{class:"box2",onMousedown:S(d=>t(e).resizeMouseDown(d,n,u),["stop"])},null,40,At),a("span",{class:"box3",onMousedown:S(d=>t(e).resizeMouseDown(d,n,u),["stop"])},null,40,Lt),a("span",{class:"box4",onMousedown:S(d=>t(e).resizeMouseDown(d,n,u),["stop"])},null,40,Ot)],46,Rt))),128))],4)])])]),_:1})]),a("div",Ht,[l(I,null,{default:i(()=>[l(he,{class:"box-card",shadow:"never"},{header:i(()=>{var n;return[a("div",Wt,[a("span",Gt,f(t(e).currentIndex==-99?t(s)("posterSet"):(n=t(e).editComponent)==null?void 0:n.componentTitle),1)])]}),default:i(()=>[a("div",Xt,[t(e).currentComponent?(p(),w(oe(U[t(e).currentComponent]),{key:0,value:t(e).value[t(e).currentIndex]},{common:i(()=>[a("div",Zt,[a("h3",Jt,f(t(s)("componentStyleTitle")),1),l(xe,{"label-width":"100px",class:"px-[10px]"},{default:i(()=>[l(h,{label:t(s)("zIndex")},{default:i(()=>[a("span",null,f(t(e).editComponent.zIndex),1)]),_:1},8,["label"]),t(e).editComponent.type=="text"?(p(),m(y,{key:0},[l(h,{label:t(s)("textFontSize")},{default:i(()=>[l(L,{modelValue:t(e).editComponent.fontSize,"onUpdate:modelValue":o[7]||(o[7]=n=>t(e).editComponent.fontSize=n),"show-input":"",size:"small",class:"ml-[10px]",min:14,max:100},null,8,["modelValue"])]),_:1},8,["label"]),l(h,{label:t(s)("textColor")},{default:i(()=>[l(Y,{modelValue:t(e).editComponent.fontColor,"onUpdate:modelValue":o[8]||(o[8]=n=>t(e).editComponent.fontColor=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(h,{label:t(s)("weight")},{default:i(()=>[l(fe,{modelValue:t(e).editComponent.weight,"onUpdate:modelValue":o[9]||(o[9]=n=>t(e).editComponent.weight=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(h,{label:t(s)("lineHeight")},{default:i(()=>[l(L,{modelValue:t(e).editComponent.lineHeight,"onUpdate:modelValue":o[10]||(o[10]=n=>t(e).editComponent.lineHeight=n),"show-input":"",size:"small",class:"ml-[10px]",min:0,max:50},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),t(e).editComponent.type=="image"?(p(),w(h,{key:1,label:t(s)("width")},{default:i(()=>[l(L,{modelValue:t(e).editComponent.width,"onUpdate:modelValue":o[11]||(o[11]=n=>t(e).editComponent.width=n),"show-input":"",size:"small",class:"ml-[10px]",min:30,max:t(e).getMaxWidth()},null,8,["modelValue","max"])]),_:1},8,["label"])):k("",!0),t(e).editComponent.type=="draw"?(p(),m(y,{key:2},[l(h,{label:t(s)("drawType")},{default:i(()=>[l(ge,{modelValue:t(e).editComponent.drawType,"onUpdate:modelValue":o[12]||(o[12]=n=>t(e).editComponent.drawType=n)},{default:i(()=>[l(ve,{label:"Polygon"},{default:i(()=>[B(f(t(s)("polygon")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(h,{label:t(s)("bgColor")},{default:i(()=>[l(Y,{modelValue:t(e).editComponent.bgColor,"onUpdate:modelValue":o[13]||(o[13]=n=>t(e).editComponent.bgColor=n)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),t(e).editComponent.type!="draw"&&t(e).editComponent.type!="image"&&t(e).editComponent.type!="qrcode"?(p(),m(y,{key:3},[l(h,{label:t(s)("horizontalAlignment")},{default:i(()=>[a("ul",Qt,[(p(!0),m(y,null,z(G.value,(n,u)=>(p(),m("li",{class:N(["w-[50px] h-[32px] flex items-center justify-center border-solid  border-[1px] border-[#eee] cursor-pointer",{"border-r-transparent":G.value.length!=u+1},n.className==t(e).editComponent.x?"!border-[var(--el-color-primary)]":""]),onClick:d=>Z("x",n)},[a("span",{class:N(["iconfont !text-[20px]",n.src]),title:n.name},null,10,Kt)],10,Yt))),256))]),a("div",eo,f(t(s)("AlignTips")),1)]),_:1},8,["label"]),l(h,{label:t(s)("verticalAlignment")},{default:i(()=>[a("ul",to,[(p(!0),m(y,null,z(X.value,(n,u)=>(p(),m("li",{class:N(["w-[50px] h-[32px] flex items-center justify-center border-solid  border-[1px] border-[#eee] cursor-pointer",{"border-r-transparent":X.value.length!=u+1},n.className==t(e).editComponent.y?"!border-[var(--el-color-primary)]":""]),onClick:d=>Z("y",n)},[a("span",{class:N(["iconfont !text-[20px]",n.src]),title:n.name},null,10,no)],10,oo))),256))])]),_:1},8,["label"])],64)):k("",!0)]),_:1})])]),_:1},8,["value"])):k("",!0)])]),_:1})]),_:1})])]),l(be,{modelValue:j.value,"onUpdate:modelValue":o[14]||(o[14]=n=>j.value=n),title:t(s)("previewDialogTitle"),width:"400px",height:"640px"},{default:i(()=>[R.value?(p(),m("div",lo,[a("img",{src:t(Ee)(R.value),class:"w-[360px] h-[640px]"},null,8,ao)])):k("",!0)]),_:1},8,["modelValue","title"])])}}});const vn=ht(so,[["__scopeId","data-v-3985b328"]]);export{vn as default};
