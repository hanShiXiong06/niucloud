import{f as Q,r as p,n as k,aZ as X,h as _,c as $,Z as Y,s as h,w as o,a as c,e,i,F as ee,W as te,t as ae,C as B,ah as le,$ as oe,E as se,L as ne,M as ie,a4 as re,a1 as de,N as pe,as as me,aj as ue,b7 as ce,ak as _e,a2 as fe,a9 as ve,V as ge,a3 as ye,p as he,g as be}from"./index-9cfed1fc.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                        *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{c as Ve,a as Ce,d as we,m as Te,s as ke,t as xe}from"./printer_template-6059aa58.js";import{_ as Ee}from"./_plugin-vue_export-helper-c27b6911.js";const Le=g=>(he("data-v-6cdfd72d"),g=g(),be(),g),Se={class:"template-list-wrap"},ze={class:"card-header"},De=Le(()=>c("span",null,"打印模板管理",-1)),Ue={class:"search-area"},$e={class:"template-name"},Be={class:"pagination-wrap"},Ne=["innerHTML"],Fe={__name:"list",setup(g){const x=Q(),b=p(!1),V=p(!1),C=p(!1),f=p(!1),N=p(""),w=p(null),E=p([]),L=p({}),n=k({template_name:"",template_type:"",status:""}),r=k({page:1,limit:20,total:0}),y=k({testData:'{"order_id": "123456", "imei": "123456789012345", "brand": "iPhone", "model": "13 Pro", "color": "深空灰", "memory": "128GB"}'}),m=async()=>{try{b.value=!0;const l={...n,page:r.page,limit:r.limit},a=await Ve(l);a.code===1&&a.data&&(E.value=a.data.data.map(s=>({...s,statusLoading:!1})),r.total=a.data.total)}catch(l){console.error("获取模板列表失败",l)}finally{b.value=!1}},F=async()=>{try{const l=await Ce();l.code===1&&(L.value=l.data)}catch(l){console.error("获取模板类型失败",l)}},I=()=>{n.template_name="",n.template_type="",n.status="",r.page=1,m()},M=()=>{x.push("/recycle/printer_template/add")},O=l=>{x.push(`/recycle/printer_template/edit/${l.template_id}`)},P=l=>{le.confirm(`确定要删除模板"${l.template_name}"吗？删除后无法恢复。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await we(l.template_id),await m()}catch(a){console.error("删除模板失败",a)}}).catch(()=>{})},H=async l=>{try{l.statusLoading=!0,await Te(l.template_id,l.status)}catch(a){console.error("切换模板状态失败",a),l.status=l.status?0:1}finally{l.statusLoading=!1}},J=async l=>{try{await ke(l.template_id),await m()}catch(a){console.error("设置默认模板失败",a)}},j=l=>{w.value=l,f.value=!0},Z=async()=>{if(w.value)try{V.value=!0;let l={};try{l=JSON.parse(y.testData)}catch{oe.error("测试数据格式错误，请输入有效的JSON格式");return}(await xe(w.value.template_id,{test_data:l})).code===1&&(f.value=!1)}catch(l){console.error("测试打印失败",l)}finally{V.value=!1}};return X(()=>{F(),m()}),(l,a)=>{const s=se,S=ne,v=ie,T=re,z=de,D=pe,A=me,u=ue,G=ce,R=_e,W=fe,q=ve,U=ge,K=ye;return _(),$("div",Se,[Y((_(),h(q,{class:"box-card"},{header:o(()=>[c("div",ze,[De,e(s,{type:"primary",onClick:M},{default:o(()=>[i("添加模板")]),_:1})])]),default:o(()=>[c("div",Ue,[e(D,{model:n,inline:""},{default:o(()=>[e(v,{label:"模板名称"},{default:o(()=>[e(S,{modelValue:n.template_name,"onUpdate:modelValue":a[0]||(a[0]=t=>n.template_name=t),placeholder:"请输入模板名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,{label:"模板类型"},{default:o(()=>[e(z,{modelValue:n.template_type,"onUpdate:modelValue":a[1]||(a[1]=t=>n.template_type=t),placeholder:"请选择模板类型",clearable:"",style:{width:"150px"}},{default:o(()=>[(_(!0),$(ee,null,te(L.value,(t,d)=>(_(),h(T,{key:d,label:t,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"状态"},{default:o(()=>[e(z,{modelValue:n.status,"onUpdate:modelValue":a[2]||(a[2]=t=>n.status=t),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:o(()=>[e(T,{label:"启用",value:1}),e(T,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:o(()=>[e(s,{type:"primary",onClick:m},{default:o(()=>[i("搜索")]),_:1}),e(s,{onClick:I},{default:o(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),e(R,{data:E.value,style:{width:"100%"},border:""},{default:o(()=>[e(u,{prop:"template_name",label:"模板名称","min-width":"150"},{default:o(({row:t})=>[c("div",$e,[c("span",null,ae(t.template_name),1),t.is_default?(_(),h(A,{key:0,type:"success",size:"small",style:{"margin-left":"8px"}},{default:o(()=>[i("默认")]),_:1})):B("",!0)])]),_:1}),e(u,{prop:"type_name",label:"模板类型",width:"120"}),e(u,{prop:"width",label:"宽度(mm)",width:"80"}),e(u,{prop:"height",label:"高度(mm)",width:"80"}),e(u,{prop:"status",label:"状态",width:"80"},{default:o(({row:t})=>[e(G,{modelValue:t.status,"onUpdate:modelValue":d=>t.status=d,"active-value":1,"inactive-value":0,onChange:d=>H(t),loading:t.statusLoading},null,8,["modelValue","onUpdate:modelValue","onChange","loading"])]),_:1}),e(u,{prop:"create_time",label:"创建时间",width:"160"}),e(u,{label:"操作",width:"280",fixed:"right"},{default:o(({row:t})=>[e(s,{type:"success",size:"small",onClick:d=>j(t)},{default:o(()=>[i("测试")]),_:2},1032,["onClick"]),e(s,{type:"warning",size:"small",onClick:d=>O(t)},{default:o(()=>[i("编辑")]),_:2},1032,["onClick"]),t.is_default?B("",!0):(_(),h(s,{key:0,type:"info",size:"small",onClick:d=>J(t)},{default:o(()=>[i(" 设为默认 ")]),_:2},1032,["onClick"])),e(s,{type:"danger",size:"small",onClick:d=>P(t)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",Be,[e(W,{"current-page":r.page,"onUpdate:current-page":a[3]||(a[3]=t=>r.page=t),"page-size":r.limit,"onUpdate:page-size":a[4]||(a[4]=t=>r.limit=t),"page-sizes":[10,20,50,100],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:m,onCurrentChange:m},null,8,["current-page","page-size","total"])])]),_:1})),[[K,b.value]]),e(U,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=t=>C.value=t),title:"模板预览",width:"800px"},{footer:o(()=>[e(s,{onClick:a[5]||(a[5]=t=>C.value=!1)},{default:o(()=>[i("关闭")]),_:1})]),default:o(()=>[c("div",{class:"preview-content",innerHTML:N.value},null,8,Ne)]),_:1},8,["modelValue"]),e(U,{modelValue:f.value,"onUpdate:modelValue":a[9]||(a[9]=t=>f.value=t),title:"测试打印",width:"600px"},{footer:o(()=>[e(s,{onClick:a[8]||(a[8]=t=>f.value=!1)},{default:o(()=>[i("取 消")]),_:1}),e(s,{type:"primary",onClick:Z,loading:V.value},{default:o(()=>[i("测试打印")]),_:1},8,["loading"])]),default:o(()=>[e(D,{model:y,"label-width":"100px"},{default:o(()=>[e(v,{label:"测试数据"},{default:o(()=>[e(S,{modelValue:y.testData,"onUpdate:modelValue":a[7]||(a[7]=t=>y.testData=t),type:"textarea",rows:8,placeholder:'请输入JSON格式的测试数据，如：{"order_id": "123456", "imei": "123456789012345"}'},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},st=Ee(Fe,[["__scopeId","data-v-6cdfd72d"]]);export{st as default};
